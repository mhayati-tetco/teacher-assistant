[{"updatedAt":"2025-11-27T10:31:15.657Z","createdAt":"2025-11-27T10:31:15.657Z","id":"SK2ABaAbUl8x3xN2","name":"Teacher Assistant-v1","description":null,"active":false,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"MOE-test","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-112,896],"id":"7775eec2-b470-4bc2-9eb5-76917b9757bb","name":"Webhook","webhookId":"f8739d25-906f-4b39-985c-297ac0e58f9d"},{"parameters":{"options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[4192,736],"id":"85d9154c-0eda-4355-b03c-cce73040e79e","name":"Respond to Webhook"},{"parameters":{"content":"## Abdullah","height":784,"width":2000,"color":3},"type":"n8n-nodes-base.stickyNote","position":[1104,1472],"typeVersion":1,"id":"a0d368e0-09af-4bbb-8c58-27ffb860bf21","name":"Sticky Note"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.body.type }}","rightValue":"content_generation","operator":{"type":"string","operation":"equals"},"id":"44eaa5ae-a48c-4f75-aa13-a1c831216abc"}],"combinator":"and"},"renameOutput":true,"outputKey":"Nora"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0bd88a55-4157-444b-99ac-7a0645ea99c2","leftValue":"={{ $json.body.type }}","rightValue":"exam_create","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Hashim"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"34a69d46-38de-4937-9f03-eb1b0a2f4155","leftValue":"={{ $json.body.action }}","rightValue":"chat","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Abdullah"}]},"options":{"fallbackOutput":2}},"type":"n8n-nodes-base.switch","typeVersion":3.3,"position":[304,896],"id":"eb81f6ed-1163-4804-879d-40891ced6368","name":"Switch"},{"parameters":{"content":"## Hashim","height":784,"width":2000,"color":4},"type":"n8n-nodes-base.stickyNote","position":[1104,672],"typeVersion":1,"id":"505640d7-204b-4c07-88b1-253d4f8e6950","name":"Sticky Note1"},{"parameters":{"jsCode":"// Convert the \"quizData\" format from AI output to the expected front-end structure\n\nconst input = $input.first().json.quizData; // Get the quizData array\nconst converted = input.map(q => {\n  const questionText = Object.keys(q.question)[0];\n  const optionsObj = q.question[questionText];\n  const optionsArray = Object.values(optionsObj);\n  const correctLetter = q.correct_answer.trim();\n  const correctIndex = \"ABCD\".indexOf(correctLetter);\n\n  return {\n    question: questionText,\n    options: optionsArray,\n    correct: correctIndex,\n    explanation: \"\"\n  };\n});\n\nreturn [\n  {\n    json: {\n      message: `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙƒÙˆÙ† Ù…Ù† ${converted.length} Ø£Ø³Ø¦Ù„Ø© ğŸ¯ Ø³ÙŠØªÙ… ÙØªØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢Ù†...`,\n      output: converted\n    }\n  }\n];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2512,1888],"id":"f00ae507-e4f3-45f8-81bd-d6e65a2d271b","name":"Code in JavaScript"},{"parameters":{"content":"## Noura","height":1344,"width":2368,"color":6},"type":"n8n-nodes-base.stickyNote","position":[928,-688],"typeVersion":1,"id":"9787ed96-f54c-472d-8319-9c2e0abc9d6e","name":"Sticky Note3"},{"parameters":{"jsCode":"// Extract and validate input data\nconst body = $input.item.json.body;\n\nreturn {\n  json: {\n    contentType: body.contentType || 'educational',\n    subject: body.subject || '',\n    topic: body.topic || '',\n    grade: body.grade || '',\n    timestamp: body.timestamp || new Date().toISOString()\n  }\n};"},"id":"fc20226f-563c-4f6d-b681-d41151059be4","name":"Extract Content Data1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1024,-32]},{"parameters":{"jsCode":"// Validate input fields\nconst data = $input.item.json;\n\nconst required = ['contentType', 'subject', 'topic', 'grade'];\nconst missing = required.filter(field => !data[field]);\n\nif (missing.length > 0) {\n  return {\n    json: {\n      valid: false,\n      error: `Missing required fields: ${missing.join(', ')}`,\n      ...data\n    }\n  };\n}\n\nreturn {\n  json: {\n    valid: true,\n    ...data\n  }\n};"},"id":"31a26719-3266-45a7-93f0-4c378b66fd94","name":"Validate Input1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1216,-32]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.valid }}","rightValue":true,"operator":{"type":"boolean","operation":"true"}}],"combinator":"and"},"renameOutput":true,"outputKey":"valid"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.valid }}","rightValue":false,"operator":{"type":"boolean","operation":"false"}}],"combinator":"and"},"renameOutput":true,"outputKey":"invalid"}]},"options":{}},"id":"297e008a-ad85-4190-a380-094248232863","name":"Check Validation1","type":"n8n-nodes-base.switch","typeVersion":3,"position":[1424,-32]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.contentType }}","rightValue":"educational","operator":{"type":"string","operation":"equals"},"id":"bb8754ac-65b4-4978-99d4-f898aeb71b9d"}],"combinator":"and"},"renameOutput":true,"outputKey":"educational"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.contentType }}","rightValue":"presentation","operator":{"type":"string","operation":"equals"},"id":"3692b7fa-9f99-4bae-848f-7a823ee39134"}],"combinator":"and"},"renameOutput":true,"outputKey":"presentation"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.contentType }}","rightValue":"worksheet","operator":{"type":"string","operation":"equals"},"id":"c428ac9b-3c61-4035-b5ee-3c1d6002f8ff"}],"combinator":"and"},"renameOutput":true,"outputKey":"worksheet"}]},"options":{}},"id":"79848ea6-c5ea-4729-a7a7-e8830a0f2a9e","name":"Switch Content Type1","type":"n8n-nodes-base.switch","typeVersion":3,"position":[1616,-144]},{"parameters":{"jsCode":"// Prepare prompt for educational content AI Agent\nconst data = $input.item.json;\n\nconst prompt = `\n\nØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:\n- Ø§Ù„Ù…Ø§Ø¯Ø©: ${data.subject}\n- Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${data.topic}\n- Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ: ${data.grade}\n\nØ£Ù†Øª Ø®Ø¨ÙŠØ± ØªØ¹Ù„ÙŠÙ…ÙŠ Ù…ØªØ®ØµØµ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø¹Ø±Ø¨ÙŠ Ø§Ø­ØªØ±Ø§ÙÙŠ. Ø£Ù†Ø´Ø¦ Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠØ§Ù‹ Ø´Ø§Ù…Ù„Ø§Ù‹ ÙˆÙ…Ù†Ø¸Ù…Ø§Ù‹.\n\nâš ï¸ Ø§ØªØ¨Ø¹ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¯Ù‚Ø©:\n\nğŸ“‹ [Ø§Ù„Ù…Ø§Ø¯Ø©] | [Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹] | [Ø§Ù„Ù…Ø³ØªÙˆÙ‰]\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“š Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nÙÙ‚Ø±ØªØ§Ù†: ØªØ¹Ø±ÙŠÙ + Ø£Ù‡Ù…ÙŠØ© - 3 Ø¥Ù„Ù‰ 4 Ø£Ø³Ø·Ø± Ù„ÙƒÙ„ ÙÙ‚Ø±Ø©.\n\nğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n- Ù‡Ø¯Ù 1\n- Ù‡Ø¯Ù 2\n- Ù‡Ø¯Ù 3\n- Ù‡Ø¯Ù 4\n\nğŸ“– Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ”¹ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø£ÙˆÙ„  \nØªØ¹Ø±ÙŠÙ Ù…Ø®ØªØµØ± (3 Ø¥Ù„Ù‰ 4 Ø£Ø³Ø·Ø±)  \nØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:  \nâ€¢ Ù†Ù‚Ø·Ø© 1  \nâ€¢ Ù†Ù‚Ø·Ø© 2  \nâ€¢ Ù†Ù‚Ø·Ø© 3  \n\nğŸ”¹ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø«Ø§Ù†ÙŠ  \nØªØ¹Ø±ÙŠÙ Ù…Ø®ØªØµØ± (3 Ø¥Ù„Ù‰ 4 Ø£Ø³Ø·Ø±)  \nØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:  \nâ€¢ Ù†Ù‚Ø·Ø© 1  \nâ€¢ Ù†Ù‚Ø·Ø© 2  \nâ€¢ Ù†Ù‚Ø·Ø© 3  \n\nğŸ”¹ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø«Ø§Ù„Ø«  \nØªØ¹Ø±ÙŠÙ Ù…Ø®ØªØµØ± (3 Ø¥Ù„Ù‰ 4 Ø£Ø³Ø·Ø±)  \nØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:  \nâ€¢ Ù†Ù‚Ø·Ø© 1  \nâ€¢ Ù†Ù‚Ø·Ø© 2  \nâ€¢ Ù†Ù‚Ø·Ø© 3  \n\nğŸ’¡ Ø£Ù…Ø«Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ©\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸŒŸ Ù…Ø«Ø§Ù„ 1: Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  \nÙ…ÙˆÙ‚Ù Ù…Ù† Ø§Ù„Ø­ÙŠØ§Ø© (Ø³Ø·Ø±Ø§Ù†)  \nØ§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø³Ø·Ø±Ø§Ù†)  \nØ§Ù„Ù†ØªÙŠØ¬Ø© (Ø³Ø·Ø± ÙˆØ§Ø­Ø¯)  \n\nğŸŒŸ Ù…Ø«Ø§Ù„ 2: Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  \nÙ…ÙˆÙ‚Ù Ù…Ù† Ø§Ù„Ø­ÙŠØ§Ø© (Ø³Ø·Ø±Ø§Ù†)  \nØ§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø³Ø·Ø±Ø§Ù†)  \nØ§Ù„Ù†ØªÙŠØ¬Ø© (Ø³Ø·Ø± ÙˆØ§Ø­Ø¯)  \n\nğŸŒŸ Ù…Ø«Ø§Ù„ 3: Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  \nÙ…ÙˆÙ‚Ù Ù…Ù† Ø§Ù„Ø­ÙŠØ§Ø© (Ø³Ø·Ø±Ø§Ù†)  \nØ§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø³Ø·Ø±Ø§Ù†)  \nØ§Ù„Ù†ØªÙŠØ¬Ø© (Ø³Ø·Ø± ÙˆØ§Ø­Ø¯)  \n\nâœï¸ ØªÙ…Ø§Ø±ÙŠÙ†\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâ­ Ø¨Ø³ÙŠØ·:  \n1. ØªÙ…Ø±ÙŠÙ†  \n2. ØªÙ…Ø±ÙŠÙ†  \n\nâ­â­ Ù…ØªÙˆØ³Ø·:  \n3. ØªÙ…Ø±ÙŠÙ†  \n4. ØªÙ…Ø±ÙŠÙ†  \n\nâ­â­â­ Ù…ØªÙ‚Ø¯Ù…:  \n5. ØªÙ…Ø±ÙŠÙ†  \n6. ØªÙ…Ø±ÙŠÙ†  \n\nğŸ“‹ Ù…Ù„Ø®Øµ\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâœ“ Ù†Ù‚Ø·Ø© 1  \nâœ“ Ù†Ù‚Ø·Ø© 2  \nâœ“ Ù†Ù‚Ø·Ø© 3  \nâœ“ Ù†Ù‚Ø·Ø© 4  \n\nâ“ ØªÙ‚ÙŠÙŠÙ… + Ø¥Ø¬Ø§Ø¨Ø§Øª\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n1. Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: X  \n2. Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: X  \n3. ØµØ­ Ø£Ùˆ Ø®Ø·Ø£ - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: X  \n4. ØµØ­ Ø£Ùˆ Ø®Ø·Ø£ - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: X  \n5. Ø³Ø¤Ø§Ù„ Ù…Ù‚Ø§Ù„ÙŠ - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: Ù†Ù…ÙˆØ°Ø¬ÙŠØ©  \n6. Ø³Ø¤Ø§Ù„ Ù…Ù‚Ø§Ù„ÙŠ - Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: Ù†Ù…ÙˆØ°Ø¬ÙŠØ©  \n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    originalData: data\n  }\n};"},"id":"c0986762-8e44-4508-b1d5-b81531d4a69e","name":"Prepare Educational Prompt1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1920,-288]},{"parameters":{"jsCode":"// Prepare prompt for presentation AI Agent\nconst data = $input.item.json;\n\nconst prompt = `\n\nØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:\n- Ø§Ù„Ù…Ø§Ø¯Ø©: ${data.subject}\n- Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${data.topic}\n- Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ: ${data.grade}\n\n\nØ£Ù†Øª Ø®Ø¨ÙŠØ± ØªØ¹Ù„ÙŠÙ…ÙŠ Ù…Ø­ØªØ±Ù ÙÙŠ ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.  \nÙ…Ù‡Ù…ØªÙƒ Ù‡ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±Ø¶ PowerPoint ØªØ¹Ù„ÙŠÙ…ÙŠ ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù…ÙƒÙˆÙ‘Ù† Ù…Ù† Ø´Ø±ÙˆØ­Ø§Øª ÙˆØ§Ø¶Ø­Ø© ÙˆØ£Ù…Ø«Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ© ÙˆØ£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù†ÙØ³Ù‡.  \nÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù†Ø¸Ù…Ù‹Ø§ØŒ ØºÙ†ÙŠÙ‘Ù‹Ø§ Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªØŒ ÙˆÙ…Ù†Ø§Ø³Ø¨Ù‹Ø§ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ù…Ø­Ø¯Ø¯ØŒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ© ÙØµÙŠØ­Ø© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„ÙÙ‡Ù….\n\nØ§ØªØ¨Ø¹ Ø¨Ø¯Ù‚Ø© Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ø±Ø¶:\n\nğŸ“ [Ø§Ù„Ù…Ø§Ø¯Ø©] | [Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹] | [Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ]\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ **Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nØ§ÙƒØªØ¨ Ù…Ù‚Ø¯Ù…Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ù…Ù† 4 Ø¥Ù„Ù‰ 6 Ø£Ø³Ø·Ø± ØªØ´Ø±Ø­ ÙÙƒØ±Ø© Ø§Ù„Ø¯Ø±Ø³ØŒ  \nØ£Ù‡Ù…ÙŠØªÙ‡ ÙÙŠ Ø­ÙŠØ§Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ ØªØ·Ø¨ÙŠÙ‚Ø§ØªÙ‡ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©ØŒ ÙˆØªØ´Ø¬Ù‘Ø¹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø°Ø§ØªÙŠ ÙˆØ§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù.\n\nğŸ¯ **Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nØ§ÙƒØªØ¨ Ù…Ù† 3 Ø¥Ù„Ù‰ 5 Ø£Ù‡Ø¯Ø§Ù ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨ØµÙŠØºØ© Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙˆØ§Ø¶Ø­Ø©ØŒ Ù…Ø«Ù„:  \n- Ø£Ù† ÙŠØ¹Ø±Ù‘Ù Ø§Ù„Ø·Ø§Ù„Ø¨ ...  \n- Ø£Ù† ÙŠÙØ³Ù‘Ø± Ø§Ù„Ø·Ø§Ù„Ø¨ ...  \n- Ø£Ù† ÙŠØ·Ø¨Ù‘Ù‚ Ø§Ù„Ø·Ø§Ù„Ø¨ ...  \n- Ø£Ù† ÙŠØ­Ù„Ù‘Ù„ Ø§Ù„Ø·Ø§Ù„Ø¨ ...  \n- Ø£Ù† ÙŠØ³ØªÙ†ØªØ¬ Ø§Ù„Ø·Ø§Ù„Ø¨ ...\n\nğŸ“– **Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ (Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ø±Ø¦ÙŠØ³Ø©)**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nÙ‚Ø³Ù‘Ù… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ù„Ù‰ Ø´Ø±Ø§Ø¦Ø­ Ù…ØªØ³Ù„Ø³Ù„Ø© Ù…Ù†Ø·Ù‚ÙŠØ© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø´Ø±Ø­ ÙØ¹Ù„ÙŠ ÙˆØ£Ù…Ø«Ù„Ø©ØŒ Ø¨Ø§Ù„ØµÙŠØºØ© Ø§Ù„ØªØ§Ù„ÙŠØ©:\n\nğŸŸ¦ **Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [X]**\nğŸ“‘ **Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:**  \nØ§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù†Ù‹Ø§ ÙˆØ§Ø¶Ø­Ù‹Ø§ ÙˆÙ…Ù†Ø§Ø³Ø¨Ù‹Ø§ Ù„Ù„ÙÙƒØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ­Ø©.\n\nğŸ“„ **Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ (Ø´Ø±Ø­ ÙØ¹Ù„ÙŠ):**  \nØ§ÙƒØªØ¨ Ø´Ø±Ø­Ù‹Ø§ ØªØ¹Ù„ÙŠÙ…ÙŠÙ‹Ø§ ÙƒØ§Ù…Ù„Ø§Ù‹ Ù…Ù† 4 Ø¥Ù„Ù‰ 6 Ø¬Ù…Ù„ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø¨Ø³Ø· ÙˆÙ…Ù†Ø·Ù‚ÙŠ.  \nÙˆØ¶Ù‘Ø­ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø£Ùˆ Ø§Ù„ÙÙƒØ±Ø© Ù…Ø¹ ØªÙØ³ÙŠØ±Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ÙˆØ§Ù‚Ø¹ÙŠ ÙˆØ³Ù‡Ù„.  \nØ§Ø³ØªØ®Ø¯Ù… Ù„ØºØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙˆØ§Ø¶Ø­Ø© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ‡Ù… ÙˆÙ„ÙŠØ³ Ø§Ù„Ø­ÙØ¸.\n\nğŸ’¡ **Ø£Ù…Ø«Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ø±ÙŠØ­Ø©:**  \nÙ‚Ø¯Ù‘Ù… Ù…Ø«Ø§Ù„Ù‹Ø§ Ø£Ùˆ Ù…Ø«Ø§Ù„ÙŠÙ† Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ† ÙŠÙˆØ¶Ù‘Ø­Ø§Ù† Ø§Ù„Ù…ÙÙ‡ÙˆÙ… (Ù…Ù† Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø£Ùˆ Ù…ÙˆØ§Ù‚Ù ØªØ¹Ù„ÙŠÙ…ÙŠØ©).  \nÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø£Ù…Ø«Ù„Ø© Ø­Ø³Ø§Ø¨ÙŠØ©ØŒ Ù„ØºÙˆÙŠØ©ØŒ Ø£Ùˆ Ø¹Ù„Ù…ÙŠØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø±Ø³.\n\nâ“ **Ø£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø±Ø­:**  \nØ¶Ø¹ Ø³Ø¤Ø§Ù„Ù‹Ø§ Ø£Ùˆ Ø³Ø¤Ø§Ù„ÙŠÙ† ÙÙŠ Ù†Ù‡Ø§ÙŠØ© ÙƒÙ„ Ø´Ø±ÙŠØ­Ø© Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„ÙÙ‡Ù… Ù…Ø«Ù„:  \n- Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯  \n- Ø³Ø¤Ø§Ù„ ØµØ­ Ø£Ùˆ Ø®Ø·Ø£  \n- Ø³Ø¤Ø§Ù„ Ù…ÙØªÙˆØ­ Ù‚ØµÙŠØ±  \n\nğŸ“‹ **ØªØ±ØªÙŠØ¨ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù…Ù‚ØªØ±Ø­:**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n1. Ø§Ù„ØºÙ„Ø§Ù â€“ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶ØŒ Ø§Ù„Ù…Ø§Ø¯Ø©ØŒ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ØŒ ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù‘Ù….  \n2. Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© â€“ Ù…Ù‚Ø¯Ù…Ø© Ø¬Ø°Ø§Ø¨Ø© Ø¹Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹.  \n3. Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©.  \n4. Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ â€“ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ + Ù…Ø«Ø§Ù„ + Ø³Ø¤Ø§Ù„ Ø¨Ø³ÙŠØ·.  \n5. Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© â€“ Ø´Ø±Ø­ Ù…ÙØµÙ„ + ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…Ù„ÙŠ + Ø³Ø¤Ø§Ù„ ØªÙØ§Ø¹Ù„ÙŠ.  \n6. Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© â€“ Ù…Ø«Ø§Ù„ Ù…ØªÙ‚Ø¯Ù… Ø£Ùˆ Ø­Ø§Ù„Ø© Ù…Ù† Ø§Ù„ÙˆØ§Ù‚Ø¹.  \n7. Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© Ø£Ùˆ Ø§Ù„Ù†Ù‚Ø§Ø´.  \n8. Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ù…Ù„Ø®Øµ â€“ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ù‡Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙŠ ØªÙ…Øª ØªØºØ·ÙŠØªÙ‡Ø§.  \n9. Ø´Ø±ÙŠØ­Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… â€“ Ø£Ø³Ø¦Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©.  \n10. Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø®ØªØ§Ù… â€“ Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ© Ù‚ØµÙŠØ±Ø© Ø£Ùˆ Ø¹Ø¨Ø§Ø±Ø© Ø´ÙƒØ±.\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    originalData: data\n  }\n};"},"id":"85bf4b24-e490-4963-8f54-436e61771dc4","name":"Prepare Presentation Prompt1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1936,-112]},{"parameters":{"jsCode":"// Prepare prompt for worksheet AI Agent\nconst data = $input.item.json;\n\nconst prompt = `\n\nØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:\n- Ø§Ù„Ù…Ø§Ø¯Ø©: ${data.subject}\n- Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${data.topic}\n- Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ: ${data.grade}\n\n\nØ£Ù†Øª Ø®Ø¨ÙŠØ± ØªØ±Ø¨ÙˆÙŠ Ù…Ø­ØªØ±Ù ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.  \nÙ…Ù‡Ù…ØªÙƒ Ù‡ÙŠ Ø¥Ù†Ø´Ø§Ø¡ **ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„ ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø·Ù„Ø§Ø¨ Ù„ÙŠÙƒØªØ¨ÙˆØ§ Ø¥Ø¬Ø§Ø¨Ø§ØªÙ‡Ù… Ø¯Ø§Ø®Ù„Ù‡Ø§**ØŒ  \nØªØ¨Ø¯Ø£ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙˆØªÙ†ØªÙ‡ÙŠ Ø¨Ù…ÙØªØ§Ø­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª (Ù„Ù„Ù…Ø¹Ù„Ù… ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„).  \nÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙØ±Ø§ØºØ§Øª ÙˆØ§Ø¶Ø­Ø© Ù„Ù„ÙƒØªØ§Ø¨Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©.  \nØ§Ø³ØªØ®Ø¯Ù… Ù„ØºØ© ÙØµÙŠØ­Ø© ÙˆØ³Ù‡Ù„Ø©ØŒ ÙˆØªÙ†Ø³ÙŠÙ‚Ù‹Ø§ Ù…Ù†Ø¸Ù…Ù‹Ø§ ÙˆÙˆØ§Ø¶Ø­Ù‹Ø§.\n\nØ§ØªØ¨Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ ÙÙŠ Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬:\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“„ **ÙˆØ±Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n**ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„:** [Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹]  \n**Ø§Ù„Ø§Ø³Ù…:** _________________________  \n**Ø§Ù„ØµÙ:** _________________________  \n**Ø§Ù„ØªØ§Ø±ÙŠØ®:** _________________________  \n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“š **Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„: Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ…**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 1:** Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:  \n1. â€¦  \n   Ø£. â€¦  \n   Ø¨. â€¦  \n   Ø¬. â€¦  \n   Ø¯. â€¦  \n   Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: ( __________________ )\n\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 2:** Ø¶Ø¹ (ØµØ­) Ø£Ùˆ (Ø®Ø·Ø£) Ø£Ù…Ø§Ù… Ø§Ù„Ø¹Ø¨Ø§Ø±Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:  \n1. â€¦ (        )  \n2. â€¦ (        )  \n3. â€¦ (        )\n\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 3:** Ø£ÙƒÙ…Ù„ Ø§Ù„ÙØ±Ø§Øº Ø¨Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©:  \n1. ____________________________  \n2. ____________________________  \n3. ____________________________\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ§  **Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„ÙŠ**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 4:** Ø­Ù„ Ø§Ù„Ù…Ø³Ø£Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©:  \n________________________________________________________  \n________________________________________________________  \n\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 5:** Ø§Ø±Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„Ù…ÙÙ‡ÙˆÙ… ÙˆØ§Ù„Ù…Ø«Ø§Ù„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨:  \n________________________________________________________  \n\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 6:** Ø§ÙƒØªØ¨ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„ Ø¨Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„ØµØ­ÙŠØ­:  \n1. ______________________________  \n2. ______________________________  \n3. ______________________________  \n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ’¡ **Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ø§Ù‚Ø¯ ÙˆØ§Ù„Ø¥Ø«Ø±Ø§Ø¡**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 7:** Ù„Ù…Ø§Ø°Ø§ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©ØŸ  \n________________________________________________________  \n________________________________________________________  \n\n**Ø§Ù„Ø³Ø¤Ø§Ù„ 8:** Ø§Ù‚ØªØ±Ø­ Ù…Ø«Ø§Ù„Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ ÙŠÙˆØ¶Ù‘Ø­ Ø§Ù„ÙÙƒØ±Ø© Ø¨Ø£Ø³Ù„ÙˆØ¨Ùƒ Ø§Ù„Ø®Ø§Øµ:  \n________________________________________________________  \n________________________________________________________  \n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“‹ **Ù…ÙØªØ§Ø­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© (Ù„Ù„Ù…Ø¹Ù„Ù… ÙÙ‚Ø·)**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n**Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„:**  \n1. Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: (Ø¬)  \n2. 1- ØµØ­ØŒ 2- Ø®Ø·Ø£ØŒ 3- ØµØ­  \n3. Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: \"...\"  \n\n**Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ:**  \n4. Ø§Ù„Ø­Ù„: \"...\"  \n5. Ø§Ù„Ù…Ø«Ø§Ù„ Ø§Ù„ØµØ­ÙŠØ­: \"...\"  \n6. Ø§Ù„Ø®Ø·ÙˆØ§Øª: \"...\"  \n\n**Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«:**  \n7. Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: \"...\"  \n8. Ù…Ø«Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ÙŠ: \"...\"  \n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    originalData: data\n  }\n};"},"id":"0e576e0b-8f28-487c-acfd-f1511ec2f9c4","name":"Prepare Worksheet Prompt1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1952,112]},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"={{ $json.chatInput }}\n","hasOutputParser":true,"options":{"systemMessage":"Ø£Ù†Øª ÙˆÙƒÙŠÙ„ Ø°ÙƒÙŠ Ù…ØªØ®ØµØµ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ Ø¹Ø±Ø¨ÙŠ Ø§Ø­ØªØ±Ø§ÙÙŠ. Ù…Ù‡Ù…ØªÙƒ Ù‡ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ Ø´Ø§Ù…Ù„ ÙˆÙ…Ù†Ø¸Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ù…Ù…ÙƒÙ†Ø©."}},"id":"e33fa7e6-8a18-4579-aa5f-21c5f053f0e8","name":"AI Agent - Educational1","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[2192,-512]},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"={{ $json.chatInput }}\n","hasOutputParser":true,"options":{"systemMessage":"Ø£Ù†Øª ÙˆÙƒÙŠÙ„ Ø°ÙƒÙŠ Ù…ØªØ®ØµØµ ÙÙŠ ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ù…Ù‡Ù…ØªÙƒ Ù‡ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±ÙˆØ¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ© ÙˆÙ…Ù†Ø¸Ù…Ø© Ù„Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©."}},"id":"ca38ff73-50c8-4be2-841f-cebc125c6d3e","name":"AI Agent - Presentation1","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[2224,-160]},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"={{ $json.chatInput }}\n","hasOutputParser":true,"options":{"systemMessage":"Ø£Ù†Øª ÙˆÙƒÙŠÙ„ Ø°ÙƒÙŠ Ù…ØªØ®ØµØµ ÙÙŠ ØªØµÙ…ÙŠÙ… Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ù…Ù‡Ù…ØªÙƒ Ù‡ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆØ±Ø§Ù‚ Ø¹Ù…Ù„ ØªÙØ§Ø¹Ù„ÙŠØ© ÙˆÙ…ØªÙ†ÙˆØ¹Ø© ØªØ³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚."}},"id":"86f60795-367d-4235-bfff-16e7ae6d7235","name":"AI Agent - Worksheet1","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[2240,240]},{"parameters":{"jsCode":"// Build educational response\nconst aiResponse = $json.output || $json.text || '';\nconst originalData = $('Prepare Educational Prompt1').first().json.originalData;\n\nreturn {\n  json: {\n    content: aiResponse,\n    contentType: 'educational',\n    fileName: `${originalData.topic}_Ù…Ø­ØªÙˆÙ‰_ØªØ¹Ù„ÙŠÙ…ÙŠ.pdf`,\n    originalData: originalData\n  }\n};"},"id":"3afbf688-f1f0-4967-967c-22f06551baf3","name":"Build Educational Response1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2624,-272]},{"parameters":{"jsCode":"// Build presentation response\nconst aiResponse = $json.output || $json.text || '';\nconst originalData = $('Prepare Presentation Prompt1').first().json.originalData;\n\nreturn {\n  json: {\n    content: aiResponse,\n    contentType: 'presentation',\n    fileName: `${originalData.topic}_Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx`,\n    originalData: originalData\n  }\n};"},"id":"49928350-c87f-44cd-b51b-5fbc30412bbc","name":"Build Presentation Response1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2624,-128]},{"parameters":{"jsCode":"// Build worksheet response\nconst aiResponse = $json.output || $json.text || '';\nconst originalData = $('Prepare Worksheet Prompt1').first().json.originalData;\n\nreturn {\n  json: {\n    content: aiResponse,\n    contentType: 'worksheet',\n    fileName: `${originalData.topic}_ÙˆØ±Ù‚Ø©_Ø¹Ù…Ù„.pdf`,\n    originalData: originalData\n  }\n};"},"id":"8d577575-9d41-417a-af68-ac22f9ef3334","name":"Build Worksheet Response1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2624,32]},{"parameters":{"jsCode":"// Generate PDF for educational content\nconst content = $json.content;\nconst fileName = $json.fileName;\nconst fileData = Buffer.from(content).toString('base64');\n\nreturn {\n  json: {\n    fileData: `data:application/pdf;base64,${fileData}`,\n    fileName: fileName,\n    mimeType: 'application/pdf',\n    content: content,\n    preview: content.substring(0, 500) + '...',\n    summary: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ PDF Ø¨Ù†Ø¬Ø§Ø­',\n    originalData: $json.originalData\n  }\n};"},"id":"79b638a9-bc2e-448c-9206-cc5a54bd807e","name":"Generate PDF - Educational1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2816,-272]},{"parameters":{"jsCode":"// Generate PowerPoint\nconst content = $json.content;\nconst fileName = $json.fileName;\nconst fileData = Buffer.from(content).toString('base64');\n\nreturn {\n  json: {\n    fileData: `data:application/vnd.openxmlformats-officedocument.presentationml.presentation;base64,${fileData}`,\n    fileName: fileName,\n    mimeType: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n    content: content,\n    preview: content.substring(0, 500) + '...',\n    summary: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ PowerPoint Ø¨Ù†Ø¬Ø§Ø­',\n    originalData: $json.originalData\n  }\n};"},"id":"2c970a79-822e-4096-9634-1f522f2dd617","name":"Generate PowerPoint1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2816,-128]},{"parameters":{"jsCode":"// Generate PDF for worksheet\nconst content = $json.content;\nconst fileName = $json.fileName;\nconst fileData = Buffer.from(content).toString('base64');\n\nreturn {\n  json: {\n    fileData: `data:application/pdf;base64,${fileData}`,\n    fileName: fileName,\n    mimeType: 'application/pdf',\n    content: content,\n    preview: content.substring(0, 500) + '...',\n    summary: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„ PDF Ø¨Ù†Ø¬Ø§Ø­',\n    originalData: $json.originalData\n  }\n};"},"id":"348c1be0-2c0b-46a4-be3e-35bf966551f6","name":"Generate PDF - Worksheet1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2816,32]},{"parameters":{"jsCode":"// Execute and finalize educational PDF\nconst data = $json;\nreturn { json: data };"},"id":"79096da8-0b98-4989-9b1e-d6d0f1d64c00","name":"Execute PDF Generation - Educational1","type":"n8n-nodes-base.code","typeVersion":2,"position":[3024,-272]},{"parameters":{"jsCode":"// Execute and finalize PPTX\nconst data = $json;\nreturn { json: data };"},"id":"f0a6501a-912d-439a-8083-ac98a2202993","name":"Execute PPTX Generation1","type":"n8n-nodes-base.code","typeVersion":2,"position":[3024,-128]},{"parameters":{"jsCode":"// Execute and finalize worksheet PDF\nconst data = $json;\nreturn { json: data };"},"id":"98bfa055-9fd2-4adf-9e61-5c7f30489004","name":"Execute PDF Generation - Worksheet1","type":"n8n-nodes-base.code","typeVersion":2,"position":[3024,32]},{"parameters":{"jsCode":"// Error response\nconst error = $json.error || 'ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª';\n\nreturn {\n  json: {\n    success: false,\n    error: error,\n    message: 'ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©',\n    details: $json\n  }\n};"},"id":"e791057b-ad90-4e2e-b267-a345381fdea2","name":"Error Response1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1600,288]},{"parameters":{"respondWith":"json","responseBody":"={{ $json }}","options":{"responseCode":400,"responseHeaders":{"entries":[{"name":"Content-Type","value":"application/json"}]}}},"id":"9e5c96ae-8ada-4f28-beee-563a9e16cfae","name":"Respond Error1","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1968,384]},{"parameters":{"model":"openai/gpt-oss-120b","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[2144,-304],"id":"28d4a9ec-6d0c-4ac7-b2af-0391a8f16867","name":"Groq Chat Model","credentials":{"groqApi":{"id":"0dbQfqMc4TNybHrP","name":"Groq account"}}},{"parameters":{"model":"openai/gpt-oss-120b","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[2192,80],"id":"10d44bff-e4cb-4673-913e-d163830b86a1","name":"Groq Chat Model2","credentials":{"groqApi":{"id":"0dbQfqMc4TNybHrP","name":"Groq account"}}},{"parameters":{"model":"openai/gpt-oss-120b","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[2176,480],"id":"c7213c30-cf8e-4e50-87a2-d7626f67bbcf","name":"Groq Chat Model3","credentials":{"groqApi":{"id":"0dbQfqMc4TNybHrP","name":"Groq account"}}},{"parameters":{"jsCode":"// This function will recursively search any object or array for \"quizData\"\nfunction findQuizData(obj) {\n  let results = [];\n\n  if (Array.isArray(obj)) {\n    for (const item of obj) {\n      results = results.concat(findQuizData(item));\n    }\n  } else if (obj && typeof obj === 'object') {\n    for (const [key, value] of Object.entries(obj)) {\n      if (key === 'quizData' ) {\n        results.push(value);\n      } else {\n        results = results.concat(findQuizData(value));\n      }\n    }\n  }\n\n  return results;\n}\n\n// Process all incoming items\nconst output = items.map(item => {\n  const found = findQuizData(item.json);\n  return {\n    json: {\n      quizData: found.length ? found.flat() : []\n    }\n  };\n});\n\nreturn output;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2304,1888],"id":"c0613224-ff60-4a77-9853-7946f78214a6","name":"Code in JavaScript3"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"08d07eea-368f-48dc-a34a-0e4d0dbe8ff6","leftValue":"={{ $json.output }}","rightValue":"normal","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1648,1808],"id":"d43416b8-15a3-49fe-a97f-b6cffe81eb20","name":"If"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2864,1776],"id":"4a3d7a53-af7e-4fc0-a919-a1d0e3afce08","name":"Merge"},{"parameters":{"workflowId":{"__rl":true,"value":"b7w5u0vPSKIuOQZl","mode":"list","cachedResultUrl":"/workflow/b7w5u0vPSKIuOQZl","cachedResultName":"Q&A"},"workflowInputs":{"mappingMode":"defineBelow","value":{"input":"={{ $('Webhook').item.json.body.chatInput }}","session_id":"={{ $('Webhook').item.json.body.sessionId }}"},"matchingColumns":[],"schema":[{"id":"input","displayName":"input","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"session_id","displayName":"session_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[2064,1696],"id":"a2cbbdad-0b37-4e78-9587-19a13cd6dbf0","name":"Call 'Q&A'"},{"parameters":{"workflowId":{"__rl":true,"value":"rCDoyvyBUHXirCne","mode":"list","cachedResultUrl":"/workflow/rCDoyvyBUHXirCne","cachedResultName":"Multiple Choice Assessment"},"workflowInputs":{"mappingMode":"defineBelow","value":{"input":"={{ $('Webhook').item.json.body.chatInput }}"},"matchingColumns":["input"],"schema":[{"id":"input","displayName":"input","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[2064,1888],"id":"db649a13-30b0-447c-b845-34fefaf8b78f","name":"Call 'Multiple Choice Assessment'"},{"parameters":{"promptType":"define","text":"={{ $json.body.chatInput }}","options":{"systemMessage":"IF User Message is normal output normal\nIF User Message is about Exam output exam\nonly answer {normal, exam}"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[1312,1808],"id":"b8adea6b-0788-4485-b67c-b88910e85d15","name":"AI Agent1"},{"parameters":{"model":"openai/gpt-oss-120b","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[1200,2048],"id":"aac6cf35-f3ed-4d43-9dbe-34f965d14b0f","name":"Groq Chat Model4","credentials":{"groqApi":{"id":"0dbQfqMc4TNybHrP","name":"Groq account"}}}],"connections":{"Webhook":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Respond to Webhook":{"main":[[]]},"Switch":{"main":[[{"node":"Extract Content Data1","type":"main","index":0}],[],[{"node":"AI Agent1","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Extract Content Data1":{"main":[[{"node":"Validate Input1","type":"main","index":0}]]},"Validate Input1":{"main":[[{"node":"Check Validation1","type":"main","index":0}]]},"Check Validation1":{"main":[[{"node":"Switch Content Type1","type":"main","index":0}],[{"node":"Error Response1","type":"main","index":0}]]},"Switch Content Type1":{"main":[[{"node":"Prepare Educational Prompt1","type":"main","index":0}],[{"node":"Prepare Presentation Prompt1","type":"main","index":0}],[{"node":"Prepare Worksheet Prompt1","type":"main","index":0}]]},"Prepare Educational Prompt1":{"main":[[{"node":"AI Agent - Educational1","type":"main","index":0}]]},"Prepare Presentation Prompt1":{"main":[[{"node":"AI Agent - Presentation1","type":"main","index":0}]]},"Prepare Worksheet Prompt1":{"main":[[{"node":"AI Agent - Worksheet1","type":"main","index":0}]]},"AI Agent - Educational1":{"main":[[{"node":"Build Educational Response1","type":"main","index":0}]]},"AI Agent - Presentation1":{"main":[[{"node":"Build Presentation Response1","type":"main","index":0}]]},"AI Agent - Worksheet1":{"main":[[{"node":"Build Worksheet Response1","type":"main","index":0}]]},"Build Educational Response1":{"main":[[{"node":"Generate PDF - Educational1","type":"main","index":0}]]},"Build Presentation Response1":{"main":[[{"node":"Generate PowerPoint1","type":"main","index":0}]]},"Build Worksheet Response1":{"main":[[{"node":"Generate PDF - Worksheet1","type":"main","index":0}]]},"Generate PDF - Educational1":{"main":[[{"node":"Execute PDF Generation - Educational1","type":"main","index":0}]]},"Generate PowerPoint1":{"main":[[{"node":"Execute PPTX Generation1","type":"main","index":0}]]},"Generate PDF - Worksheet1":{"main":[[{"node":"Execute PDF Generation - Worksheet1","type":"main","index":0}]]},"Error Response1":{"main":[[{"node":"Respond Error1","type":"main","index":0}]]},"Execute PDF Generation - Educational1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Execute PPTX Generation1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Execute PDF Generation - Worksheet1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Groq Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Educational1","type":"ai_languageModel","index":0}]]},"Groq Chat Model2":{"ai_languageModel":[[{"node":"AI Agent - Presentation1","type":"ai_languageModel","index":0}]]},"Groq Chat Model3":{"ai_languageModel":[[{"node":"AI Agent - Worksheet1","type":"ai_languageModel","index":0}]]},"Code in JavaScript3":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"If":{"main":[[{"node":"Call 'Q&A'","type":"main","index":0}],[{"node":"Call 'Multiple Choice Assessment'","type":"main","index":0}]]},"Call 'Q&A'":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Call 'Multiple Choice Assessment'":{"main":[[{"node":"Code in JavaScript3","type":"main","index":0}]]},"AI Agent1":{"main":[[{"node":"If","type":"main","index":0}]]},"Groq Chat Model4":{"ai_languageModel":[[{"node":"AI Agent1","type":"ai_languageModel","index":0}]]},"Merge":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false},"staticData":null,"meta":{"templateCredsSetupCompleted":true,"instanceId":"6f0d6796e008e7d64628bb2b28849f9fc77b21782d89c1cd37b0ff2d07921dd7"},"pinData":{},"versionId":"0d4da37c-88f4-4c78-8208-06464b9b710a","versionCounter":2,"triggerCount":0,"tags":[],"shared":[{"updatedAt":"2025-11-27T10:31:15.687Z","createdAt":"2025-11-27T10:31:15.687Z","role":"workflow:owner","workflowId":"SK2ABaAbUl8x3xN2","projectId":"o0O5USm39pN3UMmO","project":{"updatedAt":"2025-11-27T10:31:45.718Z","createdAt":"2025-11-27T10:23:36.590Z","id":"o0O5USm39pN3UMmO","name":"Norah  Hussain <norahhussain26@gmail.com>","type":"personal","icon":null,"description":null}}]},{"updatedAt":"2025-11-23T06:51:12.000Z","createdAt":"2025-11-23T06:17:53.281Z","id":"L8OP8ikUluR2zebo","name":"Groq Test Workflow","description":null,"active":false,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"test-groq","responseMode":"lastNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[0,0],"id":"f641908d-1a96-4b99-9530-b2b1f249b848","name":"Webhook","webhookId":"fb188ed6-a959-4240-85b4-ca12c23f0685"},{"parameters":{"method":"POST","url":"https://api.groq.com/openai/v1/chat/completions","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer YOUR_GROQ_API_KEY"},{"name":"Content-Type","value":"=application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"model\": \"openai/gpt-oss-120b\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"{{$json.body.text}}\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 500\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[208,0],"id":"e4283244-9fbe-429b-876c-305850e2d23c","name":"HTTP Request"}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"369f2fa8-e03c-4b5e-bfab-ec4f1dd542c2","versionCounter":24,"triggerCount":1,"tags":[],"shared":[{"updatedAt":"2025-11-27T10:31:22.431Z","createdAt":"2025-11-27T10:31:22.431Z","role":"workflow:owner","workflowId":"L8OP8ikUluR2zebo","projectId":"o0O5USm39pN3UMmO","project":{"updatedAt":"2025-11-27T10:31:45.718Z","createdAt":"2025-11-27T10:23:36.590Z","id":"o0O5USm39pN3UMmO","name":"Norah  Hussain <norahhussain26@gmail.com>","type":"personal","icon":null,"description":null}}]},{"updatedAt":"2025-11-23T06:17:36.723Z","createdAt":"2025-11-23T06:17:36.723Z","id":"EE6MtVlTIdgpzeN4","name":"My workflow","description":null,"active":false,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"test-groq","responseMode":"lastNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[0,0],"id":"f641908d-1a96-4b99-9530-b2b1f249b848","name":"Webhook","webhookId":"fb188ed6-a959-4240-85b4-ca12c23f0685"},{"parameters":{"method":"POST","url":"https://api.groq.com/openai/v1/chat/completions","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer YOUR_GROQ_API_KEY"},{"name":"Content-Type","value":"=application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n     \"model\": \"mixtral-8x7b-32768\",\n     \"messages\": [\n       {\n         \"role\": \"system\",\n         \"content\": \"You are a helpful teacher assistant\"\n       },\n       {\n         \"role\": \"user\",\n         \"content\": \"{{ $json.text }}\"\n       }\n     ],\n     \"temperature\": 0.7,\n     \"max_tokens\": 500\n   }","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[208,0],"id":"e4283244-9fbe-429b-876c-305850e2d23c","name":"HTTP Request"}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"4f887a31-7fda-4117-981a-8c811c1a5e6d","versionCounter":4,"triggerCount":0,"tags":[],"shared":[{"updatedAt":"2025-11-27T10:31:28.871Z","createdAt":"2025-11-27T10:31:28.871Z","role":"workflow:owner","workflowId":"EE6MtVlTIdgpzeN4","projectId":"o0O5USm39pN3UMmO","project":{"updatedAt":"2025-11-27T10:31:45.718Z","createdAt":"2025-11-27T10:23:36.590Z","id":"o0O5USm39pN3UMmO","name":"Norah  Hussain <norahhussain26@gmail.com>","type":"personal","icon":null,"description":null}}]},{"updatedAt":"2025-12-07T07:30:05.000Z","createdAt":"2025-12-07T07:29:34.969Z","id":"PSbJXxE1lW6o3ylx","name":"Presentation Generation (Docker)","description":null,"active":false,"isArchived":true,"nodes":[{"parameters":{"promptType":"define","text":"=Retrieve educational content for this topic:\n\nGrade: {{ $json.body.grade }}\nSubject: {{ $json.body.subject }}\nUnit: {{ $json.body.unit }}\nTopic: {{ $json.body.topic }}\n\nRetrieve ALL relevant content from the textbook about this specific topic.","hasOutputParser":true,"options":{"systemMessage":"You are a content retrieval agent specialized in extracting educational content from Saudi Ministry of Education textbooks stored in Pinecone.\n\nYour task is to retrieve ALL relevant content about the requested topic from the vector database.\n\nIMPORTANT INSTRUCTIONS:\n1. Use the Pinecone tool to search for content related to the grade, subject, unit, and topic\n2. Retrieve as much relevant content as possible\n3. Return the complete retrieved content without summarization\n4. Preserve the original Arabic text exactly as it appears\n5. Include explanations, examples, and any educational material found\n\nYou MUST use the Pinecone retrieval tool - never answer from your own knowledge.\n\nReturn the retrieved content in clear, structured format maintaining all Arabic text."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[-1680,192],"id":"154a95ad-7f2c-4f92-8b37-f32d5083766d","name":"Stage 1: Content Retriever Agent9"},{"parameters":{"modelName":"Omartificial-Intelligence-Space/Arabic-Triplet-Matryoshka-V2","options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsHuggingFaceInference","typeVersion":1,"position":[-1536,752],"id":"49204cff-6e37-4a47-8a2a-1cb79f4e1a69","name":"Embeddings HuggingFace9"},{"parameters":{"options":{"temperature":0.1}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[-1744,496],"id":"3d4ea101-cb0b-4767-9140-83950990628b","name":"OpenAI Chat Model - Retrieval9"},{"parameters":{"model":"gpt-4o","options":{"temperature":0.7}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[-1136,496],"id":"674cb5a0-7aa8-4f3e-8f47-eaca1a50eb0a","name":"OpenAI Chat Model - Presentation9"},{"parameters":{"httpMethod":"POST","path":"presentation-generator","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-2080,240],"id":"817a23eb-fa0f-44a2-b427-0825cbcfc0a2","name":"Webhook9","webhookId":"presentation-generator"},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Use this tool to retrieve information ONLY from the Pinecone textbook database. Never answer from your own knowledge without calling this tool.","pineconeIndex":{"__rl":true,"value":"science","mode":"list","cachedResultName":"science"},"topK":120,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1.3,"position":[-1536,480],"id":"9413fef4-d169-4642-956e-ffb2009d2672","name":"Pinecone Vector Store9"},{"parameters":{"jsCode":"// Prepare presentation generation prompt with retrieved content\nconst retrievedContent = $json.output || $json.text || '';\nconst data = $('Webhook9').first().json.body;\n\nconst prompt = `\nYou are a professional educational designer creating PowerPoint presentations for Saudi Ministry of Education curriculum.\n\nPRESENTATION INFORMATION:\n- Subject: ${data.subject}\n- Unit: ${data.unit}\n- Topic: ${data.topic}\n- Grade Level: ${data.grade}\n\nRETRIEVED TEXTBOOK CONTENT (USE THIS AS YOUR PRIMARY SOURCE):\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n${retrievedContent}\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nCRITICAL INSTRUCTIONS:\nâœ“ Write ALL content in Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰)\nâœ“ Use the retrieved content above as your PRIMARY source\nâœ“ Include emojis exactly as shown in the structure\nâœ“ Write COMPLETE, DETAILED content - not instructions or placeholders\nâœ“ Each content slide must be comprehensive and self-contained\nâœ“ Minimum 6-8 sentences for each main explanation\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nREQUIRED STRUCTURE - FOLLOW EXACTLY:\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©\n\n[Write 5-6 complete sentences in Arabic introducing the topic. Explain:\n- What the lesson is about\n- Why it's important for students\n- How it relates to daily life\n- Encouragement to explore and learn\nDO NOT write \"write an introduction\" - WRITE THE ACTUAL INTRODUCTION]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©\n\n[Write 5-6 complete learning objectives in Arabic, each on a new line:\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ¹Ø±ÙŠÙ... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø´Ø±Ø­... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ­Ù„ÙŠÙ„... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ø³ØªÙ†ØªØ§Ø¬... [complete objective]\nDO NOT write \"objectives:\" - WRITE THE ACTUAL OBJECTIVES]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“– Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ\n\n[Create 5-7 content slides. For EACH slide, you MUST include ALL four sections below]\n\nğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [1]\n\nğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:\n[Write ONE clear, specific title in Arabic - NO instructions, just the title]\n\nğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ÙØ¹Ù„ÙŠ):\n[Extract information from the RETRIEVED CONTENT above and write 6-8 COMPLETE sentences in Arabic explaining the concept in detail. Use simple, clear language. Focus on understanding. DO NOT write \"write an explanation\" - WRITE THE ACTUAL DETAILED EXPLANATION with full sentences]\n\nğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\n[Write 2-3 REAL examples in Arabic from the retrieved content. Each example should be 1-2 sentences. DO NOT write \"example:\" - WRITE THE ACTUAL EXAMPLES]\n\nâ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:\n[Write 2-3 ACTUAL questions in Arabic to test understanding:\n- [Complete question 1 with all answer choices if multiple choice]\n- [Complete question 2]\n- [Complete question 3]\nDO NOT write \"question:\" - WRITE THE ACTUAL QUESTIONS]\n\nğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [2]\n\nğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:\n[Write title]\n\nğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ÙØ¹Ù„ÙŠ):\n[Write 6-8 complete sentences]\n\nğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\n[Write 2-3 actual examples]\n\nâ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:\n[Write 2-3 actual questions]\n\n[Continue for slides 3, 4, 5, 6, 7...]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nREMEMBER:\n1. Keep emojis (ğŸŸ¦ ğŸ“‘ ğŸ“„ ğŸ’¡ â“) exactly as shown\n2. Each slide MUST have all 4 sections: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ + Ø§Ù„Ø£Ù…Ø«Ù„Ø© + Ø§Ù„Ø£Ø³Ø¦Ù„Ø©\n3. Use the RETRIEVED CONTENT above as your main source\n4. Write 6-8 full sentences for each Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ section\n5. Make examples specific and practical from the textbook\n6. Write complete questions, not just \"question:\"\n7. Use natural, clear Arabic appropriate for ${data.grade}\n8. Extract maximum information from the retrieved content\n\nSTART WRITING THE COMPLETE PRESENTATION NOW:\n`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    retrievedContent: retrievedContent,\n    originalData: data\n  }\n};"},"id":"c0e7fe50-fe79-4bc7-9044-2efc3d547ea0","name":"Prepare Presentation Prompt9","type":"n8n-nodes-base.code","typeVersion":2,"position":[-1344,192]},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"={{ $json.chatInput }}","hasOutputParser":true,"options":{"systemMessage":"You are an expert educational content creator for Saudi Ministry of Education.\n\nYour mission:\n- Create comprehensive educational presentations in Arabic\n- Use retrieved textbook content as the PRIMARY and MAIN source\n- Extract ALL relevant information from the provided content\n- Structure information into detailed, complete slides\n\nCRITICAL RULES:\n1. EVERY content slide MUST have ALL 4 components:\n   - ğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (clear title)\n   - ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (6-8 complete sentences of explanation)\n   - ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ© (2-3 real examples)\n   - â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© (2-3 complete questions)\n\n2. Keep emojis in the output (ğŸŸ¦ ğŸ“‘ ğŸ“„ ğŸ’¡ â“)\n\n3. Write ACTUAL content, never write meta-instructions like:\n   âŒ \"Ø§ÙƒØªØ¨ Ø´Ø±Ø­Ø§Ù‹...\" \n   âŒ \"write an explanation...\"\n   âŒ \"[Write examples]\"\n   âœ“ Write the actual explanation, examples, and questions\n\n4. Use the retrieved textbook content extensively - extract maximum information\n\n5. Each Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ section needs 6-8 FULL sentences explaining the concept in detail\n\n6. Make slides comprehensive and information-rich based on the retrieved content\n\nRemember: You're not giving instructions - you're creating the actual presentation content."}},"id":"66ed409f-5c5e-4f22-aeb0-18c6f1c3ddc7","name":"AI Agent - Presentation Generator9","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[-1120,192]},{"parameters":{"jsCode":"// Parse and structure the AI-generated presentation content\nconst aiResponse = $json.output || $json.text || '';\nconst originalData = $('Prepare Presentation Prompt9').first().json.originalData;\n\nreturn {\n  json: {\n    presentationContent: aiResponse,\n    metadata: {\n      subject: originalData.subject,\n      unit: originalData.unit,\n      topic: originalData.topic,\n      grade: originalData.grade,\n      generatedAt: new Date().toISOString()\n    }\n  }\n};"},"id":"e9d8a9c1-d5e5-43f0-ac0e-5976eaffad76","name":"Structure Presentation Data9","type":"n8n-nodes-base.code","typeVersion":2,"position":[-752,192]},{"parameters":{"jsCode":"// Create slides from the AI-generated content\nconst content = $json.presentationContent || '';\nconst metadata = $json.metadata || {};\n\n\nconst slides = [];\n\nfunction extractSection(content, startMarker, endMarker) {\n  if (!content) return '';\n  const startIndex = content.indexOf(startMarker);\n  if (startIndex === -1) return '';\n  const contentAfterStart = content.substring(startIndex + startMarker.length);\n  if (!endMarker) return contentAfterStart.trim();\n  const endIndex = contentAfterStart.indexOf(endMarker);\n  const extracted = endIndex !== -1 ? contentAfterStart.substring(0, endIndex) : contentAfterStart;\n  return extracted.trim();\n}\n\nfunction cleanText(text) {\n  if (!text) return '';\n  return text.replace(/\\*\\*/g, '').replace(/\\*/g, '').replace(/^â”+$/gm, '').replace(/^â”€+$/gm, '').replace(/\\n{3,}/g, '\\n\\n').trim();\n}\n\nlet introduction = extractSection(content, 'ğŸ“‹ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©', 'ğŸ¯');\nif (!introduction) introduction = extractSection(content, 'Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©', 'ğŸ¯');\n\nlet objectives = extractSection(content, 'ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'ğŸ“–');\nif (!objectives) objectives = extractSection(content, 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'ğŸ“–');\n\nlet mainContent = extractSection(content, 'ğŸ“– Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', '');\nif (!mainContent) mainContent = extractSection(content, 'Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', '');\nif (!mainContent) mainContent = content;\n\nslides.push({\n  type: 'cover',\n  title: metadata.topic || 'Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ ØªØ¹Ù„ÙŠÙ…ÙŠ',\n  subtitle: `${metadata.subject || ''} | ${metadata.grade || ''}`,\n  content: metadata.unit || ''\n});\n\nif (introduction && introduction.length > 20) {\n  slides.push({ type: 'introduction', title: 'Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©', content: cleanText(introduction) });\n}\n\nif (objectives && objectives.length > 20) {\n  slides.push({ type: 'objectives', title: 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', content: cleanText(objectives) });\n}\n\nconst slidePatterns = [\n  /ğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… \\[(\\d+)\\]([\\s\\S]*?)(?=ğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù…|$)/g,\n  /ğŸŸ¦ \\*\\*Slide Number \\[(\\d+)\\]\\*\\*([\\s\\S]*?)(?=ğŸŸ¦|$)/g,\n];\n\nlet contentSlides = [];\n\nfor (const pattern of slidePatterns) {\n  const tempSlides = [];\n  let match;\n  while ((match = pattern.exec(mainContent)) !== null) {\n    const slideNumber = parseInt(match[1]);\n    const slideContent = match[2];\n    let title = extractSection(slideContent, 'ğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', 'ğŸ“„');\n    if (!title) title = extractSection(slideContent, 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', '\\n\\n');\n    let mainText = extractSection(slideContent, 'ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'ğŸ’¡');\n    if (!mainText) mainText = extractSection(slideContent, 'Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'ğŸ’¡');\n    let examples = extractSection(slideContent, 'ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:', 'â“');\n    if (!examples) examples = extractSection(slideContent, 'Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©', 'â“');\n    let questions = extractSection(slideContent, 'â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:', 'ğŸŸ¦');\n    if (!questions) questions = extractSection(slideContent, 'Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©', 'ğŸŸ¦');\n    if (!questions) questions = extractSection(slideContent, 'â“', '');\n    let fullContent = '';\n    if (mainText && mainText.length > 20) fullContent += cleanText(mainText) + '\\n\\n';\n    if (examples && examples.length > 10) fullContent += 'ğŸ’¡ Ø£Ù…Ø«Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\\n' + cleanText(examples) + '\\n\\n';\n    if (questions && questions.length > 10) fullContent += 'â“ Ø£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ©:\\n' + cleanText(questions);\n    if (fullContent.trim().length > 30) {\n      tempSlides.push({ type: 'content', slideNumber: slideNumber, title: cleanText(title) || `Ø´Ø±ÙŠØ­Ø© ${slideNumber}`, content: fullContent.trim() });\n    }\n  }\n  if (tempSlides.length > 0) { contentSlides = tempSlides; break; }\n}\n\nif (contentSlides.length === 0 && mainContent.length > 100) {\n  const paragraphs = mainContent.split(/\\n\\n+/).map(p => p.trim()).filter(p => p.length > 100 && !p.startsWith('â”') && !p.startsWith('â”€'));\n  paragraphs.slice(0, 6).forEach((para, idx) => {\n    const lines = para.split('\\n');\n    let title = `Ù†Ù‚Ø·Ø© Ø±Ø¦ÙŠØ³ÙŠØ© ${idx + 1}`;\n    let content = para;\n    if (lines.length > 1 && lines[0].length < 80) {\n      title = lines[0].replace(/[ğŸŸ¦ğŸ“‘ğŸ“„ğŸ’¡â“]/g, '').trim();\n      content = lines.slice(1).join('\\n').trim();\n    }\n    contentSlides.push({ type: 'content', slideNumber: idx + 1, title: cleanText(title), content: cleanText(content) });\n  });\n}\n\ncontentSlides.sort((a, b) => a.slideNumber - b.slideNumber);\nslides.push(...contentSlides);\n\nslides.push({\n  type: 'summary',\n  title: 'Ø§Ù„Ù…Ù„Ø®Øµ',\n  content: `ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ù‡Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙŠ ØªÙ…Øª ØªØºØ·ÙŠØªÙ‡Ø§ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ:\\n\\nâ€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${contentSlides.length}\\nâ€¢ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${metadata.topic || ''}\\nâ€¢ Ø§Ù„Ù…Ø§Ø¯Ø©: ${metadata.subject || ''}\\nâ€¢ Ø§Ù„ØµÙ: ${metadata.grade || ''}`\n});\n\nslides.push({\n  type: 'closing',\n  title: 'Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…',\n  content: 'Ù†ØªÙ…Ù†Ù‰ Ù„ÙƒÙ… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ Ø±Ø­Ù„ØªÙƒÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸ“\\n\\nØ§Ø³ØªÙ…Ø±ÙˆØ§ ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ·ÙˆØ±'\n});\n\nreturn {\n  json: {\n    slides: slides,\n    metadata: metadata,\n    \n    slideCount: slides.length,\n    contentSlidesCount: contentSlides.length\n  }\n};"},"id":"17baf045-5eaf-444c-a8fa-71edb88d7bcb","name":"Create Slides Structure9","type":"n8n-nodes-base.code","typeVersion":2,"position":[-512,192]},{"parameters":{"jsCode":"const data = $json;\nconst slides = data.slides || [];\nconst metadata = data.metadata || {};\n\n// Build presentationTitle for Google Slides\nconst presentationTitle = `${metadata.topic || ''} - ${metadata.subject || ''} (${metadata.grade || ''})`.trim();\n\nreturn { \n  json: { \n    presentationTitle, \n    slides, \n    metadata\n  } \n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-240,192],"id":"d8befd5b-0c6d-48dc-a91d-9845a50fd999","name":"Prepare Google Slides Data9"},{"parameters":{"method":"POST","url":"https://slides.googleapis.com/v1/presentations","authentication":"predefinedCredentialType","nodeCredentialType":"googleSlidesOAuth2Api","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify({ title: $json.presentationTitle }) }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[0,0],"id":"2ef9cf38-481a-4123-8c2f-6c53840cffab","name":"Google Slides - Create Presentation9"},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":2,"position":[272,192],"id":"bd25fd5b-1f7b-4b43-9991-7a7da00748cb","name":"Merge Slides Data9"},{"parameters":{"jsCode":"const data = $json;\nconst presentationId = data.presentationId;\nconst slides = data.slides || [];\nconst metadata = data.metadata || {};\nconst requests = [];\n\nfunction createContentSlideRequests(slideObjectId, titleText, bodyText) {\n  const reqs = [];\n  reqs.push({ createSlide: { objectId: slideObjectId, slideLayoutReference: { predefinedLayout: 'BLANK' } } });\n  const hasTitle = titleText && titleText.trim().length > 0;\n  const hasBody = bodyText && bodyText.trim().length > 0;\n  if (!hasTitle && !hasBody) return reqs;\n  if (hasTitle) {\n    const titleShapeId = `${slideObjectId}_title`;\n    reqs.push({ createShape: { objectId: titleShapeId, shapeType: 'TEXT_BOX', elementProperties: { pageObjectId: slideObjectId, size: { width: { magnitude: 8000000, unit: 'EMU' }, height: { magnitude: 800000, unit: 'EMU' } }, transform: { scaleX: 1, scaleY: 1, translateX: 700000, translateY: 400000, unit: 'EMU' } } } });\n    reqs.push({ insertText: { objectId: titleShapeId, insertionIndex: 0, text: titleText.trim() } });\n    reqs.push({ updateTextStyle: { objectId: titleShapeId, style: { bold: true, fontSize: { magnitude: 28, unit: 'PT' }, foregroundColor: { opaqueColor: { rgbColor: { red: 0.2, green: 0.2, blue: 0.5 } } } }, fields: 'bold,fontSize,foregroundColor' } });\n    reqs.push({ updateParagraphStyle: { objectId: titleShapeId, style: { direction: 'RIGHT_TO_LEFT', alignment: 'CENTER' }, fields: 'direction,alignment' } });\n  }\n  if (hasBody) {\n    const bodyShapeId = `${slideObjectId}_body`;\n    reqs.push({ createShape: { objectId: bodyShapeId, shapeType: 'TEXT_BOX', elementProperties: { pageObjectId: slideObjectId, size: { width: { magnitude: 8000000, unit: 'EMU' }, height: { magnitude: 4500000, unit: 'EMU' } }, transform: { scaleX: 1, scaleY: 1, translateX: 700000, translateY: 1400000, unit: 'EMU' } } } });\n    reqs.push({ insertText: { objectId: bodyShapeId, insertionIndex: 0, text: bodyText.trim() } });\n    reqs.push({ updateTextStyle: { objectId: bodyShapeId, style: { fontSize: { magnitude: 16, unit: 'PT' } }, fields: 'fontSize' } });\n    reqs.push({ updateParagraphStyle: { objectId: bodyShapeId, style: { direction: 'RIGHT_TO_LEFT', alignment: 'START' }, fields: 'direction,alignment' } });\n  }\n  return reqs;\n}\n\nfor (let i = 0; i < slides.length; i++) {\n  const slide = slides[i];\n  const slideId = `slide_${slide.type}_${i}`;\n  let title = (slide.title || '').trim();\n  let content = (slide.content || slide.subtitle || '').trim();\n  if (slide.type === 'content') title = title || `Ø´Ø±ÙŠØ­Ø© ${slide.slideNumber || i}`;\n  const slideRequests = createContentSlideRequests(slideId, title, content);\n  const validRequests = slideRequests.filter(req => req && Object.keys(req).length > 0);\n  requests.push(...validRequests);\n}\n\nconst finalRequests = requests.filter(req => {\n  if (!req || typeof req !== 'object') return false;\n  return Object.keys(req).length > 0;\n});\n\nreturn { json: { presentationId, requests: finalRequests, metadata, totalRequests: finalRequests.length, slideCount: slides.length } };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[528,192],"id":"5beca076-2b22-4d13-a3ff-48073bf4bf86","name":"Build Slides Requests9"},{"parameters":{"method":"POST","url":"=https://slides.googleapis.com/v1/presentations/{{$json.presentationId}}:batchUpdate","authentication":"predefinedCredentialType","nodeCredentialType":"googleSlidesOAuth2Api","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify({ requests: $json.requests }) }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[784,192],"id":"f39b5a2f-3ca1-448e-919f-9fd04700081d","name":"Google Slides - BatchUpdate9"},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1056,192],"id":"220fc13e-fc98-462a-8286-c9c6b939ce40","name":"Merge Metadata with Response1"},{"parameters":{"jsCode":"// Get merged data - now we have both metadata and presentationId\nconst data = $json;\n\n// presentationId comes from BatchUpdate\nconst presentationId = data.presentationId;\nconst presentationLink = `https://docs.google.com/presentation/d/${presentationId}/edit`;\n\n// metadata comes from Build Slides Requests (merged)\nconst metadata = data.metadata || {};\nconst slideCount = data.slideCount || 0;\n\n// FIXED: Create file name correctly (topic first, then suffix)\nconst fileName = metadata.topic ? `${metadata.topic}_Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx` : 'Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx';\n\nreturn {\n  json: {\n    success: true,\n    message: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ Ø¹Ù„Ù‰ Google Slides Ø¨Ù†Ø¬Ø§Ø­ âœ…',\n    presentationLink: presentationLink,\n    presentationId: presentationId,\n    metadata: {\n      subject: metadata.subject || '',\n      unit: metadata.unit || '',\n      topic: metadata.topic || '',\n      grade: metadata.grade || '',\n      fileName: fileName,\n      slideCount: slideCount,\n      generatedAt: metadata.generatedAt || ''\n    },\n    generatedAt: new Date().toISOString()\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1248,192],"id":"3b30a344-04f2-4a7f-ac61-62135042deaa","name":"Format Slides Response9"},{"parameters":{"respondWith":"json","responseBody":"={{ $json }}","options":{"responseHeaders":{"entries":[{"name":"Content-Type","value":"application/json"},{"name":"Access-Control-Allow-Origin","value":"*"}]}}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[1488,192],"id":"8d1dba70-743d-4a6c-a50a-06f5a162b002","name":"Respond to Webhook9"},{"parameters":{"content":"## Greate ","color":3},"type":"n8n-nodes-base.stickyNote","position":[-1024,656],"typeVersion":1,"id":"dfb38813-9534-4c03-851d-af1ff3e1bac3","name":"Sticky Note"}],"connections":{"Stage 1: Content Retriever Agent9":{"main":[[{"node":"Prepare Presentation Prompt9","type":"main","index":0}]]},"Embeddings HuggingFace9":{"ai_embedding":[[{"node":"Pinecone Vector Store9","type":"ai_embedding","index":0}]]},"OpenAI Chat Model - Retrieval9":{"ai_languageModel":[[{"node":"Stage 1: Content Retriever Agent9","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Presentation9":{"ai_languageModel":[[{"node":"AI Agent - Presentation Generator9","type":"ai_languageModel","index":0}]]},"Webhook9":{"main":[[{"node":"Stage 1: Content Retriever Agent9","type":"main","index":0}]]},"Pinecone Vector Store9":{"ai_tool":[[{"node":"Stage 1: Content Retriever Agent9","type":"ai_tool","index":0}]]},"Prepare Presentation Prompt9":{"main":[[{"node":"AI Agent - Presentation Generator9","type":"main","index":0}]]},"AI Agent - Presentation Generator9":{"main":[[{"node":"Structure Presentation Data9","type":"main","index":0}]]},"Structure Presentation Data9":{"main":[[{"node":"Create Slides Structure9","type":"main","index":0}]]},"Create Slides Structure9":{"main":[[{"node":"Prepare Google Slides Data9","type":"main","index":0}]]},"Prepare Google Slides Data9":{"main":[[{"node":"Google Slides - Create Presentation9","type":"main","index":0},{"node":"Merge Slides Data9","type":"main","index":1}]]},"Google Slides - Create Presentation9":{"main":[[{"node":"Merge Slides Data9","type":"main","index":0}]]},"Merge Slides Data9":{"main":[[{"node":"Build Slides Requests9","type":"main","index":0}]]},"Build Slides Requests9":{"main":[[{"node":"Google Slides - BatchUpdate9","type":"main","index":0},{"node":"Merge Metadata with Response1","type":"main","index":0}]]},"Google Slides - BatchUpdate9":{"main":[[{"node":"Merge Metadata with Response1","type":"main","index":1}]]},"Merge Metadata with Response1":{"main":[[{"node":"Format Slides Response9","type":"main","index":0}]]},"Format Slides Response9":{"main":[[{"node":"Respond to Webhook9","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"a957ec42-f3ec-45b4-9d0a-bf99681bd063","versionCounter":2,"triggerCount":0,"tags":[],"shared":[{"updatedAt":"2025-12-07T07:29:35.006Z","createdAt":"2025-12-07T07:29:35.006Z","role":"workflow:owner","workflowId":"PSbJXxE1lW6o3ylx","projectId":"o0O5USm39pN3UMmO","project":{"updatedAt":"2025-11-27T10:31:45.718Z","createdAt":"2025-11-27T10:23:36.590Z","id":"o0O5USm39pN3UMmO","name":"Norah  Hussain <norahhussain26@gmail.com>","type":"personal","icon":null,"description":null}}]},{"updatedAt":"2025-12-08T04:53:54.000Z","createdAt":"2025-12-07T07:29:38.938Z","id":"CBvZFktjeuDy8ifk","name":"Presentation Generation (Docker)","description":null,"active":false,"isArchived":true,"nodes":[{"parameters":{"promptType":"define","text":"=Retrieve educational content for this topic:\n\nGrade: {{ $json.body.grade }}\nSubject: {{ $json.body.subject }}\nUnit: {{ $json.body.unit }}\nTopic: {{ $json.body.topic }}\n\nRetrieve ALL relevant content from the textbook about this specific topic.","hasOutputParser":true,"options":{"systemMessage":"You are a content retrieval agent specialized in extracting educational content from Saudi Ministry of Education textbooks stored in Pinecone.\n\nYour task is to retrieve ALL relevant content about the requested topic from the vector database.\n\nIMPORTANT INSTRUCTIONS:\n1. Use the Pinecone tool to search for content related to the grade, subject, unit, and topic\n2. Retrieve as much relevant content as possible\n3. Return the complete retrieved content without summarization\n4. Preserve the original Arabic text exactly as it appears\n5. Include explanations, examples, and any educational material found\n\nYou MUST use the Pinecone retrieval tool - never answer from your own knowledge.\n\nReturn the retrieved content in clear, structured format maintaining all Arabic text."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[-1680,192],"id":"154a95ad-7f2c-4f92-8b37-f32d5083766d","name":"Stage 1: Content Retriever Agent9"},{"parameters":{"modelName":"Omartificial-Intelligence-Space/Arabic-Triplet-Matryoshka-V2","options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsHuggingFaceInference","typeVersion":1,"position":[-1536,752],"id":"49204cff-6e37-4a47-8a2a-1cb79f4e1a69","name":"Embeddings HuggingFace9"},{"parameters":{"options":{"temperature":0.1}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[-1744,496],"id":"3d4ea101-cb0b-4767-9140-83950990628b","name":"OpenAI Chat Model - Retrieval9"},{"parameters":{"model":"gpt-4o","options":{"temperature":0.7}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[-1136,496],"id":"674cb5a0-7aa8-4f3e-8f47-eaca1a50eb0a","name":"OpenAI Chat Model - Presentation9"},{"parameters":{"httpMethod":"POST","path":"presentation-generator","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-2080,240],"id":"817a23eb-fa0f-44a2-b427-0825cbcfc0a2","name":"Webhook9","webhookId":"presentation-generator"},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Use this tool to retrieve information ONLY from the Pinecone textbook database. Never answer from your own knowledge without calling this tool.","pineconeIndex":{"__rl":true,"value":"science","mode":"list","cachedResultName":"science"},"topK":120,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1.3,"position":[-1536,480],"id":"9413fef4-d169-4642-956e-ffb2009d2672","name":"Pinecone Vector Store9"},{"parameters":{"jsCode":"// Prepare presentation generation prompt with retrieved content\nconst retrievedContent = $json.output || $json.text || '';\nconst data = $('Webhook9').first().json.body;\n\nconst prompt = `\nYou are a professional educational designer creating PowerPoint presentations for Saudi Ministry of Education curriculum.\n\nPRESENTATION INFORMATION:\n- Subject: ${data.subject}\n- Unit: ${data.unit}\n- Topic: ${data.topic}\n- Grade Level: ${data.grade}\n\nRETRIEVED TEXTBOOK CONTENT (USE THIS AS YOUR PRIMARY SOURCE):\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n${retrievedContent}\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nCRITICAL INSTRUCTIONS:\nâœ“ Write ALL content in Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰)\nâœ“ Use the retrieved content above as your PRIMARY source\nâœ“ Include emojis exactly as shown in the structure\nâœ“ Write COMPLETE, DETAILED content - not instructions or placeholders\nâœ“ Each content slide must be comprehensive and self-contained\nâœ“ Minimum 6-8 sentences for each main explanation\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nREQUIRED STRUCTURE - FOLLOW EXACTLY:\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©\n\n[Write 5-6 complete sentences in Arabic introducing the topic. Explain:\n- What the lesson is about\n- Why it's important for students\n- How it relates to daily life\n- Encouragement to explore and learn\nDO NOT write \"write an introduction\" - WRITE THE ACTUAL INTRODUCTION]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©\n\n[Write 5-6 complete learning objectives in Arabic, each on a new line:\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ¹Ø±ÙŠÙ... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø´Ø±Ø­... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ­Ù„ÙŠÙ„... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ø³ØªÙ†ØªØ§Ø¬... [complete objective]\nDO NOT write \"objectives:\" - WRITE THE ACTUAL OBJECTIVES]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“– Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ\n\n[Create 5-7 content slides. For EACH slide, you MUST include ALL four sections below]\n\nğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [1]\n\nğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:\n[Write ONE clear, specific title in Arabic - NO instructions, just the title]\n\nğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ÙØ¹Ù„ÙŠ):\n[Extract information from the RETRIEVED CONTENT above and write 6-8 COMPLETE sentences in Arabic explaining the concept in detail. Use simple, clear language. Focus on understanding. DO NOT write \"write an explanation\" - WRITE THE ACTUAL DETAILED EXPLANATION with full sentences]\n\nğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\n[Write 2-3 REAL examples in Arabic from the retrieved content. Each example should be 1-2 sentences. DO NOT write \"example:\" - WRITE THE ACTUAL EXAMPLES]\n\nâ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:\n[Write 2-3 ACTUAL questions in Arabic to test understanding:\n- [Complete question 1 with all answer choices if multiple choice]\n- [Complete question 2]\n- [Complete question 3]\nDO NOT write \"question:\" - WRITE THE ACTUAL QUESTIONS]\n\nğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [2]\n\nğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:\n[Write title]\n\nğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ÙØ¹Ù„ÙŠ):\n[Write 6-8 complete sentences]\n\nğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\n[Write 2-3 actual examples]\n\nâ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:\n[Write 2-3 actual questions]\n\n[Continue for slides 3, 4, 5, 6, 7...]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nREMEMBER:\n1. Keep emojis (ğŸŸ¦ ğŸ“‘ ğŸ“„ ğŸ’¡ â“) exactly as shown\n2. Each slide MUST have all 4 sections: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ + Ø§Ù„Ø£Ù…Ø«Ù„Ø© + Ø§Ù„Ø£Ø³Ø¦Ù„Ø©\n3. Use the RETRIEVED CONTENT above as your main source\n4. Write 6-8 full sentences for each Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ section\n5. Make examples specific and practical from the textbook\n6. Write complete questions, not just \"question:\"\n7. Use natural, clear Arabic appropriate for ${data.grade}\n8. Extract maximum information from the retrieved content\n\nSTART WRITING THE COMPLETE PRESENTATION NOW:\n`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    retrievedContent: retrievedContent,\n    originalData: data\n  }\n};"},"id":"c0e7fe50-fe79-4bc7-9044-2efc3d547ea0","name":"Prepare Presentation Prompt9","type":"n8n-nodes-base.code","typeVersion":2,"position":[-1344,192]},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"={{ $json.chatInput }}","hasOutputParser":true,"options":{"systemMessage":"You are an expert educational content creator for Saudi Ministry of Education.\n\nYour mission:\n- Create comprehensive educational presentations in Arabic\n- Use retrieved textbook content as the PRIMARY and MAIN source\n- Extract ALL relevant information from the provided content\n- Structure information into detailed, complete slides\n\nCRITICAL RULES:\n1. EVERY content slide MUST have ALL 4 components:\n   - ğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (clear title)\n   - ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (6-8 complete sentences of explanation)\n   - ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ© (2-3 real examples)\n   - â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© (2-3 complete questions)\n\n2. Keep emojis in the output (ğŸŸ¦ ğŸ“‘ ğŸ“„ ğŸ’¡ â“)\n\n3. Write ACTUAL content, never write meta-instructions like:\n   âŒ \"Ø§ÙƒØªØ¨ Ø´Ø±Ø­Ø§Ù‹...\" \n   âŒ \"write an explanation...\"\n   âŒ \"[Write examples]\"\n   âœ“ Write the actual explanation, examples, and questions\n\n4. Use the retrieved textbook content extensively - extract maximum information\n\n5. Each Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ section needs 6-8 FULL sentences explaining the concept in detail\n\n6. Make slides comprehensive and information-rich based on the retrieved content\n\nRemember: You're not giving instructions - you're creating the actual presentation content."}},"id":"66ed409f-5c5e-4f22-aeb0-18c6f1c3ddc7","name":"AI Agent - Presentation Generator9","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[-1120,192]},{"parameters":{"jsCode":"// Parse and structure the AI-generated presentation content\nconst aiResponse = $json.output || $json.text || '';\nconst originalData = $('Prepare Presentation Prompt9').first().json.originalData;\n\nreturn {\n  json: {\n    presentationContent: aiResponse,\n    metadata: {\n      subject: originalData.subject,\n      unit: originalData.unit,\n      topic: originalData.topic,\n      grade: originalData.grade,\n      generatedAt: new Date().toISOString()\n    }\n  }\n};"},"id":"e9d8a9c1-d5e5-43f0-ac0e-5976eaffad76","name":"Structure Presentation Data9","type":"n8n-nodes-base.code","typeVersion":2,"position":[-752,192]},{"parameters":{"jsCode":"// Create slides from the AI-generated content\nconst content = $json.presentationContent || '';\nconst metadata = $json.metadata || {};\n\n\nconst slides = [];\n\nfunction extractSection(content, startMarker, endMarker) {\n  if (!content) return '';\n  const startIndex = content.indexOf(startMarker);\n  if (startIndex === -1) return '';\n  const contentAfterStart = content.substring(startIndex + startMarker.length);\n  if (!endMarker) return contentAfterStart.trim();\n  const endIndex = contentAfterStart.indexOf(endMarker);\n  const extracted = endIndex !== -1 ? contentAfterStart.substring(0, endIndex) : contentAfterStart;\n  return extracted.trim();\n}\n\nfunction cleanText(text) {\n  if (!text) return '';\n  return text.replace(/\\*\\*/g, '').replace(/\\*/g, '').replace(/^â”+$/gm, '').replace(/^â”€+$/gm, '').replace(/\\n{3,}/g, '\\n\\n').trim();\n}\n\nlet introduction = extractSection(content, 'ğŸ“‹ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©', 'ğŸ¯');\nif (!introduction) introduction = extractSection(content, 'Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©', 'ğŸ¯');\n\nlet objectives = extractSection(content, 'ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'ğŸ“–');\nif (!objectives) objectives = extractSection(content, 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'ğŸ“–');\n\nlet mainContent = extractSection(content, 'ğŸ“– Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', '');\nif (!mainContent) mainContent = extractSection(content, 'Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', '');\nif (!mainContent) mainContent = content;\n\nslides.push({\n  type: 'cover',\n  title: metadata.topic || 'Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ ØªØ¹Ù„ÙŠÙ…ÙŠ',\n  subtitle: `${metadata.subject || ''} | ${metadata.grade || ''}`,\n  content: metadata.unit || ''\n});\n\nif (introduction && introduction.length > 20) {\n  slides.push({ type: 'introduction', title: 'Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©', content: cleanText(introduction) });\n}\n\nif (objectives && objectives.length > 20) {\n  slides.push({ type: 'objectives', title: 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', content: cleanText(objectives) });\n}\n\nconst slidePatterns = [\n  /ğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… \\[(\\d+)\\]([\\s\\S]*?)(?=ğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù…|$)/g,\n  /ğŸŸ¦ \\*\\*Slide Number \\[(\\d+)\\]\\*\\*([\\s\\S]*?)(?=ğŸŸ¦|$)/g,\n];\n\nlet contentSlides = [];\n\nfor (const pattern of slidePatterns) {\n  const tempSlides = [];\n  let match;\n  while ((match = pattern.exec(mainContent)) !== null) {\n    const slideNumber = parseInt(match[1]);\n    const slideContent = match[2];\n    let title = extractSection(slideContent, 'ğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', 'ğŸ“„');\n    if (!title) title = extractSection(slideContent, 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', '\\n\\n');\n    let mainText = extractSection(slideContent, 'ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'ğŸ’¡');\n    if (!mainText) mainText = extractSection(slideContent, 'Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'ğŸ’¡');\n    let examples = extractSection(slideContent, 'ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:', 'â“');\n    if (!examples) examples = extractSection(slideContent, 'Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©', 'â“');\n    let questions = extractSection(slideContent, 'â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:', 'ğŸŸ¦');\n    if (!questions) questions = extractSection(slideContent, 'Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©', 'ğŸŸ¦');\n    if (!questions) questions = extractSection(slideContent, 'â“', '');\n    let fullContent = '';\n    if (mainText && mainText.length > 20) fullContent += cleanText(mainText) + '\\n\\n';\n    if (examples && examples.length > 10) fullContent += 'ğŸ’¡ Ø£Ù…Ø«Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\\n' + cleanText(examples) + '\\n\\n';\n    if (questions && questions.length > 10) fullContent += 'â“ Ø£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ©:\\n' + cleanText(questions);\n    if (fullContent.trim().length > 30) {\n      tempSlides.push({ type: 'content', slideNumber: slideNumber, title: cleanText(title) || `Ø´Ø±ÙŠØ­Ø© ${slideNumber}`, content: fullContent.trim() });\n    }\n  }\n  if (tempSlides.length > 0) { contentSlides = tempSlides; break; }\n}\n\nif (contentSlides.length === 0 && mainContent.length > 100) {\n  const paragraphs = mainContent.split(/\\n\\n+/).map(p => p.trim()).filter(p => p.length > 100 && !p.startsWith('â”') && !p.startsWith('â”€'));\n  paragraphs.slice(0, 6).forEach((para, idx) => {\n    const lines = para.split('\\n');\n    let title = `Ù†Ù‚Ø·Ø© Ø±Ø¦ÙŠØ³ÙŠØ© ${idx + 1}`;\n    let content = para;\n    if (lines.length > 1 && lines[0].length < 80) {\n      title = lines[0].replace(/[ğŸŸ¦ğŸ“‘ğŸ“„ğŸ’¡â“]/g, '').trim();\n      content = lines.slice(1).join('\\n').trim();\n    }\n    contentSlides.push({ type: 'content', slideNumber: idx + 1, title: cleanText(title), content: cleanText(content) });\n  });\n}\n\ncontentSlides.sort((a, b) => a.slideNumber - b.slideNumber);\nslides.push(...contentSlides);\n\nslides.push({\n  type: 'summary',\n  title: 'Ø§Ù„Ù…Ù„Ø®Øµ',\n  content: `ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ù‡Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙŠ ØªÙ…Øª ØªØºØ·ÙŠØªÙ‡Ø§ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ:\\n\\nâ€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${contentSlides.length}\\nâ€¢ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${metadata.topic || ''}\\nâ€¢ Ø§Ù„Ù…Ø§Ø¯Ø©: ${metadata.subject || ''}\\nâ€¢ Ø§Ù„ØµÙ: ${metadata.grade || ''}`\n});\n\nslides.push({\n  type: 'closing',\n  title: 'Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…',\n  content: 'Ù†ØªÙ…Ù†Ù‰ Ù„ÙƒÙ… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ Ø±Ø­Ù„ØªÙƒÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸ“\\n\\nØ§Ø³ØªÙ…Ø±ÙˆØ§ ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ·ÙˆØ±'\n});\n\nreturn {\n  json: {\n    slides: slides,\n    metadata: metadata,\n    \n    slideCount: slides.length,\n    contentSlidesCount: contentSlides.length\n  }\n};"},"id":"17baf045-5eaf-444c-a8fa-71edb88d7bcb","name":"Create Slides Structure9","type":"n8n-nodes-base.code","typeVersion":2,"position":[-512,192]},{"parameters":{"jsCode":"const data = $json;\nconst slides = data.slides || [];\nconst metadata = data.metadata || {};\n\n// Build presentationTitle for Google Slides\nconst presentationTitle = `${metadata.topic || ''} - ${metadata.subject || ''} (${metadata.grade || ''})`.trim();\n\nreturn { \n  json: { \n    presentationTitle, \n    slides, \n    metadata\n  } \n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-240,192],"id":"d8befd5b-0c6d-48dc-a91d-9845a50fd999","name":"Prepare Google Slides Data9"},{"parameters":{"method":"POST","url":"https://slides.googleapis.com/v1/presentations","authentication":"predefinedCredentialType","nodeCredentialType":"googleSlidesOAuth2Api","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify({ title: $json.presentationTitle }) }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[0,0],"id":"2ef9cf38-481a-4123-8c2f-6c53840cffab","name":"Google Slides - Create Presentation9"},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":2,"position":[272,192],"id":"bd25fd5b-1f7b-4b43-9991-7a7da00748cb","name":"Merge Slides Data9"},{"parameters":{"jsCode":"const data = $json;\nconst presentationId = data.presentationId;\nconst slides = data.slides || [];\nconst metadata = data.metadata || {};\nconst requests = [];\n\nfunction createContentSlideRequests(slideObjectId, titleText, bodyText) {\n  const reqs = [];\n  reqs.push({ createSlide: { objectId: slideObjectId, slideLayoutReference: { predefinedLayout: 'BLANK' } } });\n  const hasTitle = titleText && titleText.trim().length > 0;\n  const hasBody = bodyText && bodyText.trim().length > 0;\n  if (!hasTitle && !hasBody) return reqs;\n  if (hasTitle) {\n    const titleShapeId = `${slideObjectId}_title`;\n    reqs.push({ createShape: { objectId: titleShapeId, shapeType: 'TEXT_BOX', elementProperties: { pageObjectId: slideObjectId, size: { width: { magnitude: 8000000, unit: 'EMU' }, height: { magnitude: 800000, unit: 'EMU' } }, transform: { scaleX: 1, scaleY: 1, translateX: 700000, translateY: 400000, unit: 'EMU' } } } });\n    reqs.push({ insertText: { objectId: titleShapeId, insertionIndex: 0, text: titleText.trim() } });\n    reqs.push({ updateTextStyle: { objectId: titleShapeId, style: { bold: true, fontSize: { magnitude: 28, unit: 'PT' }, foregroundColor: { opaqueColor: { rgbColor: { red: 0.2, green: 0.2, blue: 0.5 } } } }, fields: 'bold,fontSize,foregroundColor' } });\n    reqs.push({ updateParagraphStyle: { objectId: titleShapeId, style: { direction: 'RIGHT_TO_LEFT', alignment: 'CENTER' }, fields: 'direction,alignment' } });\n  }\n  if (hasBody) {\n    const bodyShapeId = `${slideObjectId}_body`;\n    reqs.push({ createShape: { objectId: bodyShapeId, shapeType: 'TEXT_BOX', elementProperties: { pageObjectId: slideObjectId, size: { width: { magnitude: 8000000, unit: 'EMU' }, height: { magnitude: 4500000, unit: 'EMU' } }, transform: { scaleX: 1, scaleY: 1, translateX: 700000, translateY: 1400000, unit: 'EMU' } } } });\n    reqs.push({ insertText: { objectId: bodyShapeId, insertionIndex: 0, text: bodyText.trim() } });\n    reqs.push({ updateTextStyle: { objectId: bodyShapeId, style: { fontSize: { magnitude: 16, unit: 'PT' } }, fields: 'fontSize' } });\n    reqs.push({ updateParagraphStyle: { objectId: bodyShapeId, style: { direction: 'RIGHT_TO_LEFT', alignment: 'START' }, fields: 'direction,alignment' } });\n  }\n  return reqs;\n}\n\nfor (let i = 0; i < slides.length; i++) {\n  const slide = slides[i];\n  const slideId = `slide_${slide.type}_${i}`;\n  let title = (slide.title || '').trim();\n  let content = (slide.content || slide.subtitle || '').trim();\n  if (slide.type === 'content') title = title || `Ø´Ø±ÙŠØ­Ø© ${slide.slideNumber || i}`;\n  const slideRequests = createContentSlideRequests(slideId, title, content);\n  const validRequests = slideRequests.filter(req => req && Object.keys(req).length > 0);\n  requests.push(...validRequests);\n}\n\nconst finalRequests = requests.filter(req => {\n  if (!req || typeof req !== 'object') return false;\n  return Object.keys(req).length > 0;\n});\n\nreturn { json: { presentationId, requests: finalRequests, metadata, totalRequests: finalRequests.length, slideCount: slides.length } };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[528,192],"id":"5beca076-2b22-4d13-a3ff-48073bf4bf86","name":"Build Slides Requests9"},{"parameters":{"method":"POST","url":"=https://slides.googleapis.com/v1/presentations/{{$json.presentationId}}:batchUpdate","authentication":"predefinedCredentialType","nodeCredentialType":"googleSlidesOAuth2Api","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify({ requests: $json.requests }) }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[784,192],"id":"f39b5a2f-3ca1-448e-919f-9fd04700081d","name":"Google Slides - BatchUpdate9"},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1056,192],"id":"220fc13e-fc98-462a-8286-c9c6b939ce40","name":"Merge Metadata with Response1"},{"parameters":{"jsCode":"// Get merged data - now we have both metadata and presentationId\nconst data = $json;\n\n// presentationId comes from BatchUpdate\nconst presentationId = data.presentationId;\nconst presentationLink = `https://docs.google.com/presentation/d/${presentationId}/edit`;\n\n// metadata comes from Build Slides Requests (merged)\nconst metadata = data.metadata || {};\nconst slideCount = data.slideCount || 0;\n\n// FIXED: Create file name correctly (topic first, then suffix)\nconst fileName = metadata.topic ? `${metadata.topic}_Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx` : 'Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx';\n\nreturn {\n  json: {\n    success: true,\n    message: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ Ø¹Ù„Ù‰ Google Slides Ø¨Ù†Ø¬Ø§Ø­ âœ…',\n    presentationLink: presentationLink,\n    presentationId: presentationId,\n    metadata: {\n      subject: metadata.subject || '',\n      unit: metadata.unit || '',\n      topic: metadata.topic || '',\n      grade: metadata.grade || '',\n      fileName: fileName,\n      slideCount: slideCount,\n      generatedAt: metadata.generatedAt || ''\n    },\n    generatedAt: new Date().toISOString()\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1248,192],"id":"3b30a344-04f2-4a7f-ac61-62135042deaa","name":"Format Slides Response9"},{"parameters":{"respondWith":"json","responseBody":"={{ $json }}","options":{"responseHeaders":{"entries":[{"name":"Content-Type","value":"application/json"},{"name":"Access-Control-Allow-Origin","value":"*"}]}}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[1488,192],"id":"8d1dba70-743d-4a6c-a50a-06f5a162b002","name":"Respond to Webhook9"},{"parameters":{"content":"## Greate ","color":3},"type":"n8n-nodes-base.stickyNote","position":[-1024,656],"typeVersion":1,"id":"dfb38813-9534-4c03-851d-af1ff3e1bac3","name":"Sticky Note"}],"connections":{"Stage 1: Content Retriever Agent9":{"main":[[{"node":"Prepare Presentation Prompt9","type":"main","index":0}]]},"Embeddings HuggingFace9":{"ai_embedding":[[{"node":"Pinecone Vector Store9","type":"ai_embedding","index":0}]]},"OpenAI Chat Model - Retrieval9":{"ai_languageModel":[[{"node":"Stage 1: Content Retriever Agent9","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Presentation9":{"ai_languageModel":[[{"node":"AI Agent - Presentation Generator9","type":"ai_languageModel","index":0}]]},"Webhook9":{"main":[[{"node":"Stage 1: Content Retriever Agent9","type":"main","index":0}]]},"Pinecone Vector Store9":{"ai_tool":[[{"node":"Stage 1: Content Retriever Agent9","type":"ai_tool","index":0}]]},"Prepare Presentation Prompt9":{"main":[[{"node":"AI Agent - Presentation Generator9","type":"main","index":0}]]},"AI Agent - Presentation Generator9":{"main":[[{"node":"Structure Presentation Data9","type":"main","index":0}]]},"Structure Presentation Data9":{"main":[[{"node":"Create Slides Structure9","type":"main","index":0}]]},"Create Slides Structure9":{"main":[[{"node":"Prepare Google Slides Data9","type":"main","index":0}]]},"Prepare Google Slides Data9":{"main":[[{"node":"Google Slides - Create Presentation9","type":"main","index":0},{"node":"Merge Slides Data9","type":"main","index":1}]]},"Google Slides - Create Presentation9":{"main":[[{"node":"Merge Slides Data9","type":"main","index":0}]]},"Merge Slides Data9":{"main":[[{"node":"Build Slides Requests9","type":"main","index":0}]]},"Build Slides Requests9":{"main":[[{"node":"Google Slides - BatchUpdate9","type":"main","index":0},{"node":"Merge Metadata with Response1","type":"main","index":0}]]},"Google Slides - BatchUpdate9":{"main":[[{"node":"Merge Metadata with Response1","type":"main","index":1}]]},"Merge Metadata with Response1":{"main":[[{"node":"Format Slides Response9","type":"main","index":0}]]},"Format Slides Response9":{"main":[[{"node":"Respond to Webhook9","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"1b6fc7ea-736d-42b5-b8e6-b28d78d41cab","versionCounter":4,"triggerCount":0,"tags":[],"shared":[{"updatedAt":"2025-12-07T07:29:38.979Z","createdAt":"2025-12-07T07:29:38.979Z","role":"workflow:owner","workflowId":"CBvZFktjeuDy8ifk","projectId":"o0O5USm39pN3UMmO","project":{"updatedAt":"2025-11-27T10:31:45.718Z","createdAt":"2025-11-27T10:23:36.590Z","id":"o0O5USm39pN3UMmO","name":"Norah  Hussain <norahhussain26@gmail.com>","type":"personal","icon":null,"description":null}}]},{"updatedAt":"2025-12-08T04:57:36.000Z","createdAt":"2025-12-08T04:54:17.938Z","id":"xfvBAxdT4l7k1yn9","name":"Presentation Generation","description":null,"active":false,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"=Retrieve educational content for this topic:\n\nGrade: {{ $json.body.grade }}\nSubject: {{ $json.body.subject }}\nUnit: {{ $json.body.unit }}\nTopic: {{ $json.body.topic }}\n\nRetrieve ALL relevant content from the textbook about this specific topic.","hasOutputParser":true,"options":{"systemMessage":"You are a content retrieval agent specialized in extracting educational content from Saudi Ministry of Education textbooks stored in Pinecone.\n\nYour task is to retrieve ALL relevant content about the requested topic from the vector database.\n\nIMPORTANT INSTRUCTIONS:\n1. Use the Pinecone tool to search for content related to the grade, subject, unit, and topic\n2. Retrieve as much relevant content as possible\n3. Return the complete retrieved content without summarization\n4. Preserve the original Arabic text exactly as it appears\n5. Include explanations, examples, and any educational material found\n\nYou MUST use the Pinecone retrieval tool - never answer from your own knowledge.\n\nReturn the retrieved content in clear, structured format maintaining all Arabic text."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[320,496],"id":"68868b01-c021-4c01-871f-9fb16a6fde25","name":"Stage 1: Content Retriever Agent"},{"parameters":{"modelName":"Omartificial-Intelligence-Space/Arabic-Triplet-Matryoshka-V2","options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsHuggingFaceInference","typeVersion":1,"position":[464,1056],"id":"659aaebb-81fc-4d45-aa29-27e84b87b84b","name":"Embeddings HuggingFace","credentials":{"huggingFaceApi":{"id":"gdO15PAvH3NdBnI6","name":"HuggingFaceApi account"}}},{"parameters":{"options":{"temperature":0.1}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[256,800],"id":"b2f5bf5e-a3f4-4edc-b934-22c92ed9f375","name":"OpenAI Chat Model - Retrieval","credentials":{"openAiApi":{"id":"rESstMvwCRZkSXzp","name":"OpenAi account"}}},{"parameters":{"model":"gpt-4o","options":{"temperature":0.7}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[864,800],"id":"87dffd49-8af6-4084-8253-52c522ebaa33","name":"OpenAI Chat Model - Presentation","credentials":{"openAiApi":{"id":"rESstMvwCRZkSXzp","name":"OpenAi account"}}},{"parameters":{"httpMethod":"POST","path":"presentation-generator","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-80,544],"id":"531f74d6-3826-432c-8bc7-872bbe389ec7","name":"Webhook","webhookId":"presentation-generator"},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Use this tool to retrieve information ONLY from the Pinecone textbook database. Never answer from your own knowledge without calling this tool.","pineconeIndex":{"__rl":true,"value":"science","mode":"list","cachedResultName":"science"},"topK":120,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1.3,"position":[464,784],"id":"3d0073e9-6b7d-4a7f-a832-f10d64c9ee1b","name":"Pinecone Vector Store","credentials":{"pineconeApi":{"id":"nNBsJs8UIq8YQVJ5","name":"PineconeApi account"}}},{"parameters":{"jsCode":"// Prepare presentation generation prompt with retrieved content\nconst retrievedContent = $json.output || $json.text || '';\nconst data = $('Webhook').first().json.body;\n\nconst prompt = `\nYou are a professional educational designer creating PowerPoint presentations for Saudi Ministry of Education curriculum.\n\nPRESENTATION INFORMATION:\n- Subject: ${data.subject}\n- Unit: ${data.unit}\n- Topic: ${data.topic}\n- Grade Level: ${data.grade}\n\nRETRIEVED TEXTBOOK CONTENT (USE THIS AS YOUR PRIMARY SOURCE):\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n${retrievedContent}\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nCRITICAL INSTRUCTIONS:\nâœ“ Write ALL content in Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰)\nâœ“ Use the retrieved content above as your PRIMARY source\nâœ“ Include emojis exactly as shown in the structure\nâœ“ Write COMPLETE, DETAILED content - not instructions or placeholders\nâœ“ Each content slide must be comprehensive and self-contained\nâœ“ Minimum 6-8 sentences for each main explanation\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nREQUIRED STRUCTURE - FOLLOW EXACTLY:\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©\n\n[Write 5-6 complete sentences in Arabic introducing the topic. Explain:\n- What the lesson is about\n- Why it's important for students\n- How it relates to daily life\n- Encouragement to explore and learn\nDO NOT write \"write an introduction\" - WRITE THE ACTUAL INTRODUCTION]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©\n\n[Write 5-6 complete learning objectives in Arabic, each on a new line:\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ¹Ø±ÙŠÙ... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø´Ø±Ø­... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† ØªØ­Ù„ÙŠÙ„... [complete objective]\n- Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ø³ØªÙ†ØªØ§Ø¬... [complete objective]\nDO NOT write \"objectives:\" - WRITE THE ACTUAL OBJECTIVES]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“– Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ\n\n[Create 5-7 content slides. For EACH slide, you MUST include ALL four sections below]\n\nğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [1]\n\nğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:\n[Write ONE clear, specific title in Arabic - NO instructions, just the title]\n\nğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ÙØ¹Ù„ÙŠ):\n[Extract information from the RETRIEVED CONTENT above and write 6-8 COMPLETE sentences in Arabic explaining the concept in detail. Use simple, clear language. Focus on understanding. DO NOT write \"write an explanation\" - WRITE THE ACTUAL DETAILED EXPLANATION with full sentences]\n\nğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\n[Write 2-3 REAL examples in Arabic from the retrieved content. Each example should be 1-2 sentences. DO NOT write \"example:\" - WRITE THE ACTUAL EXAMPLES]\n\nâ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:\n[Write 2-3 ACTUAL questions in Arabic to test understanding:\n- [Complete question 1 with all answer choices if multiple choice]\n- [Complete question 2]\n- [Complete question 3]\nDO NOT write \"question:\" - WRITE THE ACTUAL QUESTIONS]\n\nğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… [2]\n\nğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:\n[Write title]\n\nğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ÙØ¹Ù„ÙŠ):\n[Write 6-8 complete sentences]\n\nğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\n[Write 2-3 actual examples]\n\nâ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:\n[Write 2-3 actual questions]\n\n[Continue for slides 3, 4, 5, 6, 7...]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nREMEMBER:\n1. Keep emojis (ğŸŸ¦ ğŸ“‘ ğŸ“„ ğŸ’¡ â“) exactly as shown\n2. Each slide MUST have all 4 sections: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ + Ø§Ù„Ø£Ù…Ø«Ù„Ø© + Ø§Ù„Ø£Ø³Ø¦Ù„Ø©\n3. Use the RETRIEVED CONTENT above as your main source\n4. Write 6-8 full sentences for each Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ section\n5. Make examples specific and practical from the textbook\n6. Write complete questions, not just \"question:\"\n7. Use natural, clear Arabic appropriate for ${data.grade}\n8. Extract maximum information from the retrieved content\n\nSTART WRITING THE COMPLETE PRESENTATION NOW:\n`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    retrievedContent: retrievedContent,\n    originalData: data\n  }\n};"},"id":"7be1d747-4e94-4dcf-879b-321d8fb937e5","name":"Prepare Presentation Prompt","type":"n8n-nodes-base.code","typeVersion":2,"position":[656,496]},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"={{ $json.chatInput }}","hasOutputParser":true,"options":{"systemMessage":"You are an expert educational content creator for Saudi Ministry of Education.\n\nYour mission:\n- Create comprehensive educational presentations in Arabic\n- Use retrieved textbook content as the PRIMARY and MAIN source\n- Extract ALL relevant information from the provided content\n- Structure information into detailed, complete slides\n\nCRITICAL RULES:\n1. EVERY content slide MUST have ALL 4 components:\n   - ğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (clear title)\n   - ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (6-8 complete sentences of explanation)\n   - ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ© (2-3 real examples)\n   - â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© (2-3 complete questions)\n\n2. Keep emojis in the output (ğŸŸ¦ ğŸ“‘ ğŸ“„ ğŸ’¡ â“)\n\n3. Write ACTUAL content, never write meta-instructions like:\n   âŒ \"Ø§ÙƒØªØ¨ Ø´Ø±Ø­Ø§Ù‹...\" \n   âŒ \"write an explanation...\"\n   âŒ \"[Write examples]\"\n   âœ“ Write the actual explanation, examples, and questions\n\n4. Use the retrieved textbook content extensively - extract maximum information\n\n5. Each Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ section needs 6-8 FULL sentences explaining the concept in detail\n\n6. Make slides comprehensive and information-rich based on the retrieved content\n\nRemember: You're not giving instructions - you're creating the actual presentation content."}},"id":"05136833-e0fb-4a4c-8f4c-2ab12a427914","name":"AI Agent - Presentation Generator","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[880,496]},{"parameters":{"jsCode":"// Parse and structure the AI-generated presentation content\nconst aiResponse = $json.output || $json.text || '';\nconst originalData = $('Prepare Presentation Prompt').first().json.originalData;\n\nreturn {\n  json: {\n    presentationContent: aiResponse,\n    metadata: {\n      subject: originalData.subject,\n      unit: originalData.unit,\n      topic: originalData.topic,\n      grade: originalData.grade,\n      generatedAt: new Date().toISOString()\n    }\n  }\n};"},"id":"7515ae28-8ddb-4e0e-a72c-10b64b713df6","name":"Structure Presentation Data","type":"n8n-nodes-base.code","typeVersion":2,"position":[1248,496]},{"parameters":{"jsCode":"// Create slides from the AI-generated content\nconst content = $json.presentationContent || '';\nconst metadata = $json.metadata || {};\n\n\nconst slides = [];\n\nfunction extractSection(content, startMarker, endMarker) {\n  if (!content) return '';\n  const startIndex = content.indexOf(startMarker);\n  if (startIndex === -1) return '';\n  const contentAfterStart = content.substring(startIndex + startMarker.length);\n  if (!endMarker) return contentAfterStart.trim();\n  const endIndex = contentAfterStart.indexOf(endMarker);\n  const extracted = endIndex !== -1 ? contentAfterStart.substring(0, endIndex) : contentAfterStart;\n  return extracted.trim();\n}\n\nfunction cleanText(text) {\n  if (!text) return '';\n  return text.replace(/\\*\\*/g, '').replace(/\\*/g, '').replace(/^â”+$/gm, '').replace(/^â”€+$/gm, '').replace(/\\n{3,}/g, '\\n\\n').trim();\n}\n\nlet introduction = extractSection(content, 'ğŸ“‹ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©', 'ğŸ¯');\nif (!introduction) introduction = extractSection(content, 'Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ø§Ù…Ø©', 'ğŸ¯');\n\nlet objectives = extractSection(content, 'ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'ğŸ“–');\nif (!objectives) objectives = extractSection(content, 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'ğŸ“–');\n\nlet mainContent = extractSection(content, 'ğŸ“– Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', '');\nif (!mainContent) mainContent = extractSection(content, 'Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', '');\nif (!mainContent) mainContent = content;\n\nslides.push({\n  type: 'cover',\n  title: metadata.topic || 'Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ ØªØ¹Ù„ÙŠÙ…ÙŠ',\n  subtitle: `${metadata.subject || ''} | ${metadata.grade || ''}`,\n  content: metadata.unit || ''\n});\n\nif (introduction && introduction.length > 20) {\n  slides.push({ type: 'introduction', title: 'Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©', content: cleanText(introduction) });\n}\n\nif (objectives && objectives.length > 20) {\n  slides.push({ type: 'objectives', title: 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', content: cleanText(objectives) });\n}\n\nconst slidePatterns = [\n  /ğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù… \\[(\\d+)\\]([\\s\\S]*?)(?=ğŸŸ¦ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø±Ù‚Ù…|$)/g,\n  /ğŸŸ¦ \\*\\*Slide Number \\[(\\d+)\\]\\*\\*([\\s\\S]*?)(?=ğŸŸ¦|$)/g,\n];\n\nlet contentSlides = [];\n\nfor (const pattern of slidePatterns) {\n  const tempSlides = [];\n  let match;\n  while ((match = pattern.exec(mainContent)) !== null) {\n    const slideNumber = parseInt(match[1]);\n    const slideContent = match[2];\n    let title = extractSection(slideContent, 'ğŸ“‘ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', 'ğŸ“„');\n    if (!title) title = extractSection(slideContent, 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', '\\n\\n');\n    let mainText = extractSection(slideContent, 'ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'ğŸ’¡');\n    if (!mainText) mainText = extractSection(slideContent, 'Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'ğŸ’¡');\n    let examples = extractSection(slideContent, 'ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:', 'â“');\n    if (!examples) examples = extractSection(slideContent, 'Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©', 'â“');\n    let questions = extractSection(slideContent, 'â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©:', 'ğŸŸ¦');\n    if (!questions) questions = extractSection(slideContent, 'Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©', 'ğŸŸ¦');\n    if (!questions) questions = extractSection(slideContent, 'â“', '');\n    let fullContent = '';\n    if (mainText && mainText.length > 20) fullContent += cleanText(mainText) + '\\n\\n';\n    if (examples && examples.length > 10) fullContent += 'ğŸ’¡ Ø£Ù…Ø«Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ÙŠØ©:\\n' + cleanText(examples) + '\\n\\n';\n    if (questions && questions.length > 10) fullContent += 'â“ Ø£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ©:\\n' + cleanText(questions);\n    if (fullContent.trim().length > 30) {\n      tempSlides.push({ type: 'content', slideNumber: slideNumber, title: cleanText(title) || `Ø´Ø±ÙŠØ­Ø© ${slideNumber}`, content: fullContent.trim() });\n    }\n  }\n  if (tempSlides.length > 0) { contentSlides = tempSlides; break; }\n}\n\nif (contentSlides.length === 0 && mainContent.length > 100) {\n  const paragraphs = mainContent.split(/\\n\\n+/).map(p => p.trim()).filter(p => p.length > 100 && !p.startsWith('â”') && !p.startsWith('â”€'));\n  paragraphs.slice(0, 6).forEach((para, idx) => {\n    const lines = para.split('\\n');\n    let title = `Ù†Ù‚Ø·Ø© Ø±Ø¦ÙŠØ³ÙŠØ© ${idx + 1}`;\n    let content = para;\n    if (lines.length > 1 && lines[0].length < 80) {\n      title = lines[0].replace(/[ğŸŸ¦ğŸ“‘ğŸ“„ğŸ’¡â“]/g, '').trim();\n      content = lines.slice(1).join('\\n').trim();\n    }\n    contentSlides.push({ type: 'content', slideNumber: idx + 1, title: cleanText(title), content: cleanText(content) });\n  });\n}\n\ncontentSlides.sort((a, b) => a.slideNumber - b.slideNumber);\nslides.push(...contentSlides);\n\nslides.push({\n  type: 'summary',\n  title: 'Ø§Ù„Ù…Ù„Ø®Øµ',\n  content: `ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ù‡Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙŠ ØªÙ…Øª ØªØºØ·ÙŠØªÙ‡Ø§ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ:\\n\\nâ€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${contentSlides.length}\\nâ€¢ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${metadata.topic || ''}\\nâ€¢ Ø§Ù„Ù…Ø§Ø¯Ø©: ${metadata.subject || ''}\\nâ€¢ Ø§Ù„ØµÙ: ${metadata.grade || ''}`\n});\n\nslides.push({\n  type: 'closing',\n  title: 'Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…',\n  content: 'Ù†ØªÙ…Ù†Ù‰ Ù„ÙƒÙ… Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ Ø±Ø­Ù„ØªÙƒÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸ“\\n\\nØ§Ø³ØªÙ…Ø±ÙˆØ§ ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ·ÙˆØ±'\n});\n\nreturn {\n  json: {\n    slides: slides,\n    metadata: metadata,\n    \n    slideCount: slides.length,\n    contentSlidesCount: contentSlides.length\n  }\n};"},"id":"7b8d5e3b-2856-40ce-a950-164f73768432","name":"Create Slides Structure","type":"n8n-nodes-base.code","typeVersion":2,"position":[1488,496]},{"parameters":{"jsCode":"const data = $json;\nconst slides = data.slides || [];\nconst metadata = data.metadata || {};\n\n// Build presentationTitle for Google Slides\nconst presentationTitle = `${metadata.topic || ''} - ${metadata.subject || ''} (${metadata.grade || ''})`.trim();\n\nreturn { \n  json: { \n    presentationTitle, \n    slides, \n    metadata\n  } \n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1760,496],"id":"f90b628c-d556-4794-bcce-88ca6f03370a","name":"Prepare Google Slides Data"},{"parameters":{"method":"POST","url":"https://slides.googleapis.com/v1/presentations","authentication":"predefinedCredentialType","nodeCredentialType":"googleSlidesOAuth2Api","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify({ title: $json.presentationTitle }) }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2000,304],"id":"708e283b-b653-43e6-a07a-5a33af6916aa","name":"Google Slides - Create Presentation","credentials":{"googleSlidesOAuth2Api":{"id":"WXCCkzIUAez1U74X","name":"Google Slides account"}}},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":2,"position":[2272,496],"id":"c2fe2e89-deee-4f77-a42d-b1d7d41126cf","name":"Merge Slides Data"},{"parameters":{"jsCode":"const data = $json;\nconst presentationId = data.presentationId;\nconst slides = data.slides || [];\nconst metadata = data.metadata || {};\nconst requests = [];\n\nfunction createContentSlideRequests(slideObjectId, titleText, bodyText) {\n  const reqs = [];\n  reqs.push({ createSlide: { objectId: slideObjectId, slideLayoutReference: { predefinedLayout: 'BLANK' } } });\n  const hasTitle = titleText && titleText.trim().length > 0;\n  const hasBody = bodyText && bodyText.trim().length > 0;\n  if (!hasTitle && !hasBody) return reqs;\n  if (hasTitle) {\n    const titleShapeId = `${slideObjectId}_title`;\n    reqs.push({ createShape: { objectId: titleShapeId, shapeType: 'TEXT_BOX', elementProperties: { pageObjectId: slideObjectId, size: { width: { magnitude: 8000000, unit: 'EMU' }, height: { magnitude: 800000, unit: 'EMU' } }, transform: { scaleX: 1, scaleY: 1, translateX: 700000, translateY: 400000, unit: 'EMU' } } } });\n    reqs.push({ insertText: { objectId: titleShapeId, insertionIndex: 0, text: titleText.trim() } });\n    reqs.push({ updateTextStyle: { objectId: titleShapeId, style: { bold: true, fontSize: { magnitude: 28, unit: 'PT' }, foregroundColor: { opaqueColor: { rgbColor: { red: 0.2, green: 0.2, blue: 0.5 } } } }, fields: 'bold,fontSize,foregroundColor' } });\n    reqs.push({ updateParagraphStyle: { objectId: titleShapeId, style: { direction: 'RIGHT_TO_LEFT', alignment: 'CENTER' }, fields: 'direction,alignment' } });\n  }\n  if (hasBody) {\n    const bodyShapeId = `${slideObjectId}_body`;\n    reqs.push({ createShape: { objectId: bodyShapeId, shapeType: 'TEXT_BOX', elementProperties: { pageObjectId: slideObjectId, size: { width: { magnitude: 8000000, unit: 'EMU' }, height: { magnitude: 4500000, unit: 'EMU' } }, transform: { scaleX: 1, scaleY: 1, translateX: 700000, translateY: 1400000, unit: 'EMU' } } } });\n    reqs.push({ insertText: { objectId: bodyShapeId, insertionIndex: 0, text: bodyText.trim() } });\n    reqs.push({ updateTextStyle: { objectId: bodyShapeId, style: { fontSize: { magnitude: 16, unit: 'PT' } }, fields: 'fontSize' } });\n    reqs.push({ updateParagraphStyle: { objectId: bodyShapeId, style: { direction: 'RIGHT_TO_LEFT', alignment: 'START' }, fields: 'direction,alignment' } });\n  }\n  return reqs;\n}\n\nfor (let i = 0; i < slides.length; i++) {\n  const slide = slides[i];\n  const slideId = `slide_${slide.type}_${i}`;\n  let title = (slide.title || '').trim();\n  let content = (slide.content || slide.subtitle || '').trim();\n  if (slide.type === 'content') title = title || `Ø´Ø±ÙŠØ­Ø© ${slide.slideNumber || i}`;\n  const slideRequests = createContentSlideRequests(slideId, title, content);\n  const validRequests = slideRequests.filter(req => req && Object.keys(req).length > 0);\n  requests.push(...validRequests);\n}\n\nconst finalRequests = requests.filter(req => {\n  if (!req || typeof req !== 'object') return false;\n  return Object.keys(req).length > 0;\n});\n\nreturn { json: { presentationId, requests: finalRequests, metadata, totalRequests: finalRequests.length, slideCount: slides.length } };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2528,496],"id":"c4d119de-6a8b-4ead-b873-0acf09dcf94d","name":"Build Slides Requests"},{"parameters":{"method":"POST","url":"=https://slides.googleapis.com/v1/presentations/{{$json.presentationId}}:batchUpdate","authentication":"predefinedCredentialType","nodeCredentialType":"googleSlidesOAuth2Api","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify({ requests: $json.requests }) }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2816,256],"id":"df9fb800-364a-4cb8-9b7a-a35360d9ea6b","name":"Google Slides - BatchUpdate"},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[3056,496],"id":"437c88e2-c919-4b04-89bd-d5e559acaadc","name":"Merge Metadata with Response"},{"parameters":{"jsCode":"// Get merged data - now we have both metadata and presentationId\nconst data = $json;\n\n// presentationId comes from BatchUpdate\nconst presentationId = data.presentationId;\nconst presentationLink = `https://docs.google.com/presentation/d/${presentationId}/edit`;\n\n// metadata comes from Build Slides Requests (merged)\nconst metadata = data.metadata || {};\nconst slideCount = data.slideCount || 0;\n\n// FIXED: Create file name correctly - topic FIRST, then suffix\nconst fileName = metadata.topic ? `${metadata.topic}_Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx` : 'Ø¹Ø±Ø¶_ØªÙ‚Ø¯ÙŠÙ…ÙŠ.pptx';\n\nreturn {\n  json: {\n    success: true,\n    message: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ Ø¹Ù„Ù‰ Google Slides Ø¨Ù†Ø¬Ø§Ø­ âœ…',\n    presentationLink: presentationLink,\n    presentationId: presentationId,\n    metadata: {\n      subject: metadata.subject || '',\n      unit: metadata.unit || '',\n      topic: metadata.topic || '',\n      grade: metadata.grade || '',\n      fileName: fileName,\n      slideCount: slideCount,\n      generatedAt: metadata.generatedAt || ''\n    },\n    generatedAt: new Date().toISOString()\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3248,496],"id":"38695a01-b6a7-4c79-8690-0a9d84b9d848","name":"Format Slides Response"},{"parameters":{"respondWith":"json","responseBody":"={{ $json }}","options":{"responseHeaders":{"entries":[{"name":"Content-Type","value":"application/json"},{"name":"Access-Control-Allow-Origin","value":"*"}]}}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[3488,496],"id":"a3f0b444-33d5-4ba2-b569-cc886efc99f4","name":"Respond to Webhook"},{"parameters":{"content":"## Greate ","color":3},"type":"n8n-nodes-base.stickyNote","position":[0,0],"typeVersion":1,"id":"e16f08e7-a870-4a21-b3ba-25abf35c6e9e","name":"Sticky Note1"}],"connections":{"Stage 1: Content Retriever Agent":{"main":[[{"node":"Prepare Presentation Prompt","type":"main","index":0}]]},"Embeddings HuggingFace":{"ai_embedding":[[{"node":"Pinecone Vector Store","type":"ai_embedding","index":0}]]},"OpenAI Chat Model - Retrieval":{"ai_languageModel":[[{"node":"Stage 1: Content Retriever Agent","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model - Presentation":{"ai_languageModel":[[{"node":"AI Agent - Presentation Generator","type":"ai_languageModel","index":0}]]},"Webhook":{"main":[[{"node":"Stage 1: Content Retriever Agent","type":"main","index":0}]]},"Pinecone Vector Store":{"ai_tool":[[{"node":"Stage 1: Content Retriever Agent","type":"ai_tool","index":0}]]},"Prepare Presentation Prompt":{"main":[[{"node":"AI Agent - Presentation Generator","type":"main","index":0}]]},"AI Agent - Presentation Generator":{"main":[[{"node":"Structure Presentation Data","type":"main","index":0}]]},"Structure Presentation Data":{"main":[[{"node":"Create Slides Structure","type":"main","index":0}]]},"Create Slides Structure":{"main":[[{"node":"Prepare Google Slides Data","type":"main","index":0}]]},"Prepare Google Slides Data":{"main":[[{"node":"Google Slides - Create Presentation","type":"main","index":0},{"node":"Merge Slides Data","type":"main","index":1}]]},"Google Slides - Create Presentation":{"main":[[{"node":"Merge Slides Data","type":"main","index":0}]]},"Merge Slides Data":{"main":[[{"node":"Build Slides Requests","type":"main","index":0}]]},"Build Slides Requests":{"main":[[{"node":"Google Slides - BatchUpdate","type":"main","index":0},{"node":"Merge Metadata with Response","type":"main","index":0}]]},"Google Slides - BatchUpdate":{"main":[[{"node":"Merge Metadata with Response","type":"main","index":1}]]},"Merge Metadata with Response":{"main":[[{"node":"Format Slides Response","type":"main","index":0}]]},"Format Slides Response":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"9f7fb04b-385b-4ac6-b48a-68e12fdb9877","versionCounter":4,"triggerCount":0,"tags":[],"shared":[{"updatedAt":"2025-12-08T04:54:17.948Z","createdAt":"2025-12-08T04:54:17.948Z","role":"workflow:owner","workflowId":"xfvBAxdT4l7k1yn9","projectId":"o0O5USm39pN3UMmO","project":{"updatedAt":"2025-11-27T10:31:45.718Z","createdAt":"2025-11-27T10:23:36.590Z","id":"o0O5USm39pN3UMmO","name":"Norah  Hussain <norahhussain26@gmail.com>","type":"personal","icon":null,"description":null}}]}]